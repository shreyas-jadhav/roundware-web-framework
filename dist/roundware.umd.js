!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.RoundwareWebFramework=t():e.RoundwareWebFramework=t()}(this,(function(){return function(){var e={705:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(540);function o(e){var t=[1/0,1/0,-1/0,-1/0];return r.coordEach(e,(function(e){t[0]>e[0]&&(t[0]=e[0]),t[1]>e[1]&&(t[1]=e[1]),t[2]<e[0]&&(t[2]=e[0]),t[3]<e[1]&&(t[3]=e[1])})),t}o.default=o,t.default=o},147:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(611);function o(e,t,n){var r=!1;t[0][0]===t[t.length-1][0]&&t[0][1]===t[t.length-1][1]&&(t=t.slice(0,t.length-1));for(var o=0,i=t.length-1;o<t.length;i=o++){var a=t[o][0],s=t[o][1],u=t[i][0],c=t[i][1];if(e[1]*(a-u)+s*(u-e[0])+c*(e[0]-a)==0&&(a-e[0])*(u-e[0])<=0&&(s-e[1])*(c-e[1])<=0)return!n;s>e[1]!=c>e[1]&&e[0]<(u-a)*(e[1]-s)/(c-s)+a&&(r=!r)}return r}t.default=function(e,t,n){if(void 0===n&&(n={}),!e)throw new Error("point is required");if(!t)throw new Error("polygon is required");var i=r.getCoord(e),a=r.getGeom(t),s=a.type,u=t.bbox,c=a.coordinates;if(u&&!1===function(e,t){return t[0]<=e[0]&&t[1]<=e[1]&&t[2]>=e[0]&&t[3]>=e[1]}(i,u))return!1;"Polygon"===s&&(c=[c]);for(var l=!1,d=0;d<c.length&&!l;d++)if(o(i,c[d][0],n.ignoreBoundary)){for(var h=!1,p=1;p<c[d].length&&!h;)o(i,c[d][p],!n.ignoreBoundary)&&(h=!0),p++;h||(l=!0)}return l}},565:function(e,t){"use strict";function n(e){var t={type:"Feature"};return Object.keys(e).forEach((function(n){switch(n){case"type":case"properties":case"geometry":return;default:t[n]=e[n]}})),t.properties=r(e.properties),t.geometry=o(e.geometry),t}function r(e){var t={};return e?(Object.keys(e).forEach((function(n){var o=e[n];"object"==typeof o?null===o?t[n]=null:Array.isArray(o)?t[n]=o.map((function(e){return e})):t[n]=r(o):t[n]=o})),t):t}function o(e){var t={type:e.type};return e.bbox&&(t.bbox=e.bbox),"GeometryCollection"===e.type?(t.geometries=e.geometries.map((function(e){return o(e)})),t):(t.coordinates=i(e.coordinates),t)}function i(e){var t=e;return"object"!=typeof t[0]?t.slice():t.map((function(e){return i(e)}))}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)throw new Error("geojson is required");switch(e.type){case"Feature":return n(e);case"FeatureCollection":return function(e){var t={type:"FeatureCollection"};return Object.keys(e).forEach((function(n){switch(n){case"type":case"features":return;default:t[n]=e[n]}})),t.features=e.features.map((function(e){return n(e)})),t}(e);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return o(e);default:throw new Error("unknown GeoJSON type")}}},13:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(611),o=n(102);t.default=function(e,t,n){void 0===n&&(n={});var i=r.getCoord(e),a=r.getCoord(t),s=o.degreesToRadians(a[1]-i[1]),u=o.degreesToRadians(a[0]-i[0]),c=o.degreesToRadians(i[1]),l=o.degreesToRadians(a[1]),d=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(u/2),2)*Math.cos(c)*Math.cos(l);return o.radiansToLength(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),n.units)}},102:function(e,t){"use strict";function n(e,t,n){void 0===n&&(n={});var r={type:"Feature"};return(0===n.id||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=t||{},r.geometry=e,r}function r(e,t,r){if(void 0===r&&(r={}),!e)throw new Error("coordinates is required");if(!Array.isArray(e))throw new Error("coordinates must be an Array");if(e.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!p(e[0])||!p(e[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:e},t,r)}function o(e,t,r){void 0===r&&(r={});for(var o=0,i=e;o<i.length;o++){var a=i[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:e},t,r)}function i(e,t,r){if(void 0===r&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:e},t,r)}function a(e,t){void 0===t&&(t={});var n={type:"FeatureCollection"};return t.id&&(n.id=t.id),t.bbox&&(n.bbox=t.bbox),n.features=e,n}function s(e,t,r){return void 0===r&&(r={}),n({type:"MultiLineString",coordinates:e},t,r)}function u(e,t,r){return void 0===r&&(r={}),n({type:"MultiPoint",coordinates:e},t,r)}function c(e,t,r){return void 0===r&&(r={}),n({type:"MultiPolygon",coordinates:e},t,r)}function l(e,n){void 0===n&&(n="kilometers");var r=t.factors[n];if(!r)throw new Error(n+" units is invalid");return e*r}function d(e,n){void 0===n&&(n="kilometers");var r=t.factors[n];if(!r)throw new Error(n+" units is invalid");return e/r}function h(e){return e%(2*Math.PI)*180/Math.PI}function p(e){return!isNaN(e)&&null!==e&&!Array.isArray(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.earthRadius=6371008.8,t.factors={centimeters:100*t.earthRadius,centimetres:100*t.earthRadius,degrees:t.earthRadius/111325,feet:3.28084*t.earthRadius,inches:39.37*t.earthRadius,kilometers:t.earthRadius/1e3,kilometres:t.earthRadius/1e3,meters:t.earthRadius,metres:t.earthRadius,miles:t.earthRadius/1609.344,millimeters:1e3*t.earthRadius,millimetres:1e3*t.earthRadius,nauticalmiles:t.earthRadius/1852,radians:1,yards:t.earthRadius/1.0936},t.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/t.earthRadius,yards:1/1.0936},t.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},t.feature=n,t.geometry=function(e,t,n){switch(void 0===n&&(n={}),e){case"Point":return r(t).geometry;case"LineString":return i(t).geometry;case"Polygon":return o(t).geometry;case"MultiPoint":return u(t).geometry;case"MultiLineString":return s(t).geometry;case"MultiPolygon":return c(t).geometry;default:throw new Error(e+" is invalid")}},t.point=r,t.points=function(e,t,n){return void 0===n&&(n={}),a(e.map((function(e){return r(e,t)})),n)},t.polygon=o,t.polygons=function(e,t,n){return void 0===n&&(n={}),a(e.map((function(e){return o(e,t)})),n)},t.lineString=i,t.lineStrings=function(e,t,n){return void 0===n&&(n={}),a(e.map((function(e){return i(e,t)})),n)},t.featureCollection=a,t.multiLineString=s,t.multiPoint=u,t.multiPolygon=c,t.geometryCollection=function(e,t,r){return void 0===r&&(r={}),n({type:"GeometryCollection",geometries:e},t,r)},t.round=function(e,t){if(void 0===t&&(t=0),t&&!(t>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,t||0);return Math.round(e*n)/n},t.radiansToLength=l,t.lengthToRadians=d,t.lengthToDegrees=function(e,t){return h(d(e,t))},t.bearingToAzimuth=function(e){var t=e%360;return t<0&&(t+=360),t},t.radiansToDegrees=h,t.degreesToRadians=function(e){return e%360*Math.PI/180},t.convertLength=function(e,t,n){if(void 0===t&&(t="kilometers"),void 0===n&&(n="kilometers"),!(e>=0))throw new Error("length must be a positive number");return l(d(e,t),n)},t.convertArea=function(e,n,r){if(void 0===n&&(n="meters"),void 0===r&&(r="kilometers"),!(e>=0))throw new Error("area must be a positive number");var o=t.areaFactors[n];if(!o)throw new Error("invalid original units");var i=t.areaFactors[r];if(!i)throw new Error("invalid final units");return e/o*i},t.isNumber=p,t.isObject=function(e){return!!e&&e.constructor===Object},t.validateBBox=function(e){if(!e)throw new Error("bbox is required");if(!Array.isArray(e))throw new Error("bbox must be an Array");if(4!==e.length&&6!==e.length)throw new Error("bbox must be an Array of 4 or 6 numbers");e.forEach((function(e){if(!p(e))throw new Error("bbox must only contain numbers")}))},t.validateId=function(e){if(!e)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof e))throw new Error("id must be a number or a string")}},611:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(102);t.getCoord=function(e){if(!e)throw new Error("coord is required");if(!Array.isArray(e)){if("Feature"===e.type&&null!==e.geometry&&"Point"===e.geometry.type)return e.geometry.coordinates;if("Point"===e.type)return e.coordinates}if(Array.isArray(e)&&e.length>=2&&!Array.isArray(e[0])&&!Array.isArray(e[1]))return e;throw new Error("coord must be GeoJSON Point or an Array of numbers")},t.getCoords=function(e){if(Array.isArray(e))return e;if("Feature"===e.type){if(null!==e.geometry)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},t.containsNumber=function e(t){if(t.length>1&&r.isNumber(t[0])&&r.isNumber(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return e(t[0]);throw new Error("coordinates must only contain numbers")},t.geojsonType=function(e,t,n){if(!t||!n)throw new Error("type and name required");if(!e||e.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.type)},t.featureOf=function(e,t,n){if(!e)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!e||"Feature"!==e.type||!e.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!e.geometry||e.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+e.geometry.type)},t.collectionOf=function(e,t,n){if(!e)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!e||"FeatureCollection"!==e.type)throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,o=e.features;r<o.length;r++){var i=o[r];if(!i||"Feature"!==i.type||!i.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!i.geometry||i.geometry.type!==t)throw new Error("Invalid input to "+n+": must be a "+t+", given "+i.geometry.type)}},t.getGeom=function(e){return"Feature"===e.type?e.geometry:e},t.getType=function(e,t){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type}},933:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(705)),i=n(611),a=n(102),s=r(n(565));function u(e,t,n,r){t=t||("Feature"===e.type?e.properties:{});var s=i.getGeom(e),u=s.coordinates,l=s.type;if(!u.length)throw new Error("line must contain coordinates");switch(l){case"LineString":return n&&(u=c(u)),a.polygon([u],t);case"MultiLineString":var d=[],h=0;return u.forEach((function(e){if(n&&(e=c(e)),r){var t=(s=(i=o.default(a.lineString(e)))[0],u=i[1],l=i[2],p=i[3],Math.abs(s-l)*Math.abs(u-p));t>h?(d.unshift(e),h=t):d.push(e)}else d.push(e);var i,s,u,l,p})),a.polygon(d,t);default:throw new Error("geometry type "+l+" is not supported")}}function c(e){var t=e[0],n=t[0],r=t[1],o=e[e.length-1],i=o[0],a=o[1];return n===i&&r===a||e.push(t),e}t.default=function(e,t){void 0===t&&(t={});var n=t.properties,r=t.autoComplete,o=t.orderCoords,c=t.mutate;switch(r=void 0===r||r,o=void 0===o||o,(c=void 0!==c&&c)||(e=s.default(e)),e.type){case"FeatureCollection":var l=[];return e.features.forEach((function(e){l.push(i.getCoords(u(e,{},r,o)))})),a.multiPolygon(l,n);default:return u(e,n,r,o)}}},540:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(102);function o(e,t,n){if(null!==e)for(var r,i,a,s,u,c,l,d,h=0,p=0,f=e.type,v="FeatureCollection"===f,m="Feature"===f,y=v?e.features.length:1,g=0;g<y;g++){u=(d=!!(l=v?e.features[g].geometry:m?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1;for(var w=0;w<u;w++){var b=0,_=0;if(null!==(s=d?l.geometries[w]:l)){c=s.coordinates;var C=s.type;switch(h=!n||"Polygon"!==C&&"MultiPolygon"!==C?0:1,C){case null:break;case"Point":if(!1===t(c,p,g,b,_))return!1;p++,b++;break;case"LineString":case"MultiPoint":for(r=0;r<c.length;r++){if(!1===t(c[r],p,g,b,_))return!1;p++,"MultiPoint"===C&&b++}"LineString"===C&&b++;break;case"Polygon":case"MultiLineString":for(r=0;r<c.length;r++){for(i=0;i<c[r].length-h;i++){if(!1===t(c[r][i],p,g,b,_))return!1;p++}"MultiLineString"===C&&b++,"Polygon"===C&&_++}"Polygon"===C&&b++;break;case"MultiPolygon":for(r=0;r<c.length;r++){for(_=0,i=0;i<c[r].length;i++){for(a=0;a<c[r][i].length-h;a++){if(!1===t(c[r][i][a],p,g,b,_))return!1;p++}_++}b++}break;case"GeometryCollection":for(r=0;r<s.geometries.length;r++)if(!1===o(s.geometries[r],t,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function i(e,t){var n;switch(e.type){case"FeatureCollection":for(n=0;n<e.features.length&&!1!==t(e.features[n].properties,n);n++);break;case"Feature":t(e.properties,0)}}function a(e,t){if("Feature"===e.type)t(e,0);else if("FeatureCollection"===e.type)for(var n=0;n<e.features.length&&!1!==t(e.features[n],n);n++);}function s(e,t){var n,r,o,i,a,s,u,c,l,d,h=0,p="FeatureCollection"===e.type,f="Feature"===e.type,v=p?e.features.length:1;for(n=0;n<v;n++){for(s=p?e.features[n].geometry:f?e.geometry:e,c=p?e.features[n].properties:f?e.properties:{},l=p?e.features[n].bbox:f?e.bbox:void 0,d=p?e.features[n].id:f?e.id:void 0,a=(u=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,o=0;o<a;o++)if(null!==(i=u?s.geometries[o]:s))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===t(i,h,c,l,d))return!1;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===t(i.geometries[r],h,c,l,d))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===t(null,h,c,l,d))return!1;h++}}function u(e,t){s(e,(function(e,n,o,i,a){var s,u=null===e?null:e.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return!1!==t(r.feature(e,o,{bbox:i,id:a}),n,0)&&void 0}switch(u){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var c=0;c<e.coordinates.length;c++){var l={type:s,coordinates:e.coordinates[c]};if(!1===t(r.feature(l,o),n,c))return!1}}))}function c(e,t){u(e,(function(e,n,i){var a=0;if(e.geometry){var s=e.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var u,c=0,l=0,d=0;return!1!==o(e,(function(o,s,h,p,f){if(void 0===u||n>c||p>l||f>d)return u=o,c=n,l=p,d=f,void(a=0);var v=r.lineString([u,o],e.properties);if(!1===t(v,n,i,f,a))return!1;a++,u=o}))&&void 0}}}))}function l(e,t){if(!e)throw new Error("geojson is required");u(e,(function(e,n,o){if(null!==e.geometry){var i=e.geometry.type,a=e.geometry.coordinates;switch(i){case"LineString":if(!1===t(e,n,o,0,0))return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(!1===t(r.lineString(a[s],e.properties),n,o,s))return!1}}}))}t.coordEach=o,t.coordReduce=function(e,t,n,r){var i=n;return o(e,(function(e,r,o,a,s){i=0===r&&void 0===n?e:t(i,e,r,o,a,s)}),r),i},t.propEach=i,t.propReduce=function(e,t,n){var r=n;return i(e,(function(e,o){r=0===o&&void 0===n?e:t(r,e,o)})),r},t.featureEach=a,t.featureReduce=function(e,t,n){var r=n;return a(e,(function(e,o){r=0===o&&void 0===n?e:t(r,e,o)})),r},t.coordAll=function(e){var t=[];return o(e,(function(e){t.push(e)})),t},t.geomEach=s,t.geomReduce=function(e,t,n){var r=n;return s(e,(function(e,o,i,a,s){r=0===o&&void 0===n?e:t(r,e,o,i,a,s)})),r},t.flattenEach=u,t.flattenReduce=function(e,t,n){var r=n;return u(e,(function(e,o,i){r=0===o&&0===i&&void 0===n?e:t(r,e,o,i)})),r},t.segmentEach=c,t.segmentReduce=function(e,t,n){var r=n,o=!1;return c(e,(function(e,i,a,s,u){r=!1===o&&void 0===n?e:t(r,e,i,a,s,u),o=!0})),r},t.lineEach=l,t.lineReduce=function(e,t,n){var r=n;return l(e,(function(e,o,i,a){r=0===o&&void 0===n?e:t(r,e,o,i,a)})),r},t.findSegment=function(e,t){if(t=t||{},!r.isObject(t))throw new Error("options is invalid");var n,o=t.featureIndex||0,i=t.multiFeatureIndex||0,a=t.geometryIndex||0,s=t.segmentIndex||0,u=t.properties;switch(e.type){case"FeatureCollection":o<0&&(o=e.features.length+o),u=u||e.features[o].properties,n=e.features[o].geometry;break;case"Feature":u=u||e.properties,n=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=e;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=c.length+s-1),r.lineString([c[s],c[s+1]],u,t);case"Polygon":return a<0&&(a=c.length+a),s<0&&(s=c[a].length+s-1),r.lineString([c[a][s],c[a][s+1]],u,t);case"MultiLineString":return i<0&&(i=c.length+i),s<0&&(s=c[i].length+s-1),r.lineString([c[i][s],c[i][s+1]],u,t);case"MultiPolygon":return i<0&&(i=c.length+i),a<0&&(a=c[i].length+a),s<0&&(s=c[i][a].length-s-1),r.lineString([c[i][a][s],c[i][a][s+1]],u,t)}throw new Error("geojson is invalid")},t.findPoint=function(e,t){if(t=t||{},!r.isObject(t))throw new Error("options is invalid");var n,o=t.featureIndex||0,i=t.multiFeatureIndex||0,a=t.geometryIndex||0,s=t.coordIndex||0,u=t.properties;switch(e.type){case"FeatureCollection":o<0&&(o=e.features.length+o),u=u||e.features[o].properties,n=e.features[o].geometry;break;case"Feature":u=u||e.properties,n=e.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=e;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var c=n.coordinates;switch(n.type){case"Point":return r.point(c,u,t);case"MultiPoint":return i<0&&(i=c.length+i),r.point(c[i],u,t);case"LineString":return s<0&&(s=c.length+s),r.point(c[s],u,t);case"Polygon":return a<0&&(a=c.length+a),s<0&&(s=c[a].length+s),r.point(c[a][s],u,t);case"MultiLineString":return i<0&&(i=c.length+i),s<0&&(s=c[i].length+s),r.point(c[i][s],u,t);case"MultiPolygon":return i<0&&(i=c.length+i),a<0&&(a=c[i].length+a),s<0&&(s=c[i][a].length-s),r.point(c[i][a][s],u,t)}throw new Error("geojson is invalid")}},892:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(13)),i=n(102),a=n(611),s=n(540),u=r(n(213));function c(e,t){return e[0]*t[0]+e[1]*t[1]}function l(e,t,n){return"planar"===n.method?u.default(e,t,n):o.default(e,t,n)}t.default=function(e,t,n){if(void 0===n&&(n={}),n.method||(n.method="geodesic"),n.units||(n.units="kilometers"),!e)throw new Error("pt is required");if(Array.isArray(e)?e=i.point(e):"Point"===e.type?e=i.feature(e):a.featureOf(e,"Point","point"),!t)throw new Error("line is required");Array.isArray(t)?t=i.lineString(t):"LineString"===t.type?t=i.feature(t):a.featureOf(t,"LineString","line");var r=1/0,o=e.geometry.coordinates;return s.segmentEach(t,(function(e){var t=e.geometry.coordinates[0],i=e.geometry.coordinates[1],a=function(e,t,n,r){var o=[n[0]-t[0],n[1]-t[1]],i=c([e[0]-t[0],e[1]-t[1]],o);if(i<=0)return l(e,t,{method:r.method,units:"degrees"});var a=c(o,o);if(a<=i)return l(e,n,{method:r.method,units:"degrees"});var s=i/a;return l(e,[t[0]+s*o[0],t[1]+s*o[1]],{method:r.method,units:"degrees"})}(o,t,i,n);a<r&&(r=a)})),i.convertLength(r,"degrees",n.units)}},213:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(102),o=n(611);t.default=function(e,t,n){void 0===n&&(n={});var i=o.getCoord(e),a=o.getCoord(t);a[0]+=a[0]-i[0]>180?-360:i[0]-a[0]>180?360:0;var s=function(e,t,n){var o=n=void 0===n?r.earthRadius:Number(n),i=e[1]*Math.PI/180,a=t[1]*Math.PI/180,s=a-i,u=Math.abs(t[0]-e[0])*Math.PI/180;u>Math.PI&&(u-=2*Math.PI);var c=Math.log(Math.tan(a/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),l=Math.abs(c)>1e-11?s/c:Math.cos(i);return Math.sqrt(s*s+l*l*u*u)*o}(i,a);return r.convertLength(s,"meters",n.units)}},382:function(e,t,n){!function(e,t,n,r){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var i=o(t),a=o(n),s=o(r),u=function(e,t,n){return{endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}},c=function(e,t,n){return{endTime:t,insertTime:n,type:"linearRampToValue",value:e}},l=function(e,t){return{startTime:t,type:"setValue",value:e}},d=function(e,t,n){return{duration:n,startTime:t,type:"setValueCurve",values:e}},h=function(e,t,n){var r=n.startTime,o=n.target,i=n.timeConstant;return o+(t-o)*Math.exp((r-e)/i)},p=function(e){return"exponentialRampToValue"===e.type},f=function(e){return"linearRampToValue"===e.type},v=function(e){return p(e)||f(e)},m=function(e){return"setValue"===e.type},y=function(e){return"setValueCurve"===e.type},g=function e(t,n,r,o){var i=t[n];return void 0===i?o:v(i)||m(i)?i.value:y(i)?i.values[i.values.length-1]:h(r,e(t,n-1,i.startTime,o),i)},w=function(e,t,n,r,o){return void 0===n?[r.insertTime,o]:v(n)?[n.endTime,n.value]:m(n)?[n.startTime,n.value]:y(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,g(e,t-1,n.startTime,o)]},b=function(e){return"cancelAndHold"===e.type},_=function(e){return"cancelScheduledValues"===e.type},C=function(e){return b(e)||_(e)?e.cancelTime:p(e)||f(e)?e.endTime:e.startTime},A=function(e,t,n,r){var o=r.endTime,i=r.value;return n===i?i:0<n&&0<i||n<0&&i<0?n*Math.pow(i/n,(e-t)/(o-t)):0},O=function(e,t,n,r){return n+(e-t)/(r.endTime-t)*(r.value-n)},S=function(e,t){var n=t.duration,r=t.startTime,o=t.values;return function(e,t){var n=Math.floor(t),r=Math.ceil(t);return n===r?e[n]:(1-(t-n))*e[n]+(1-(r-t))*e[r]}(o,(e-r)/n*(o.length-1))},P=function(e){return"setTarget"===e.type},x=function(){function e(t){a.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return s.default(e,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(e){var t=C(e);if(b(e)||_(e)){var n=this._automationEvents.findIndex((function(n){return _(e)&&y(n)?n.startTime+n.duration>=t:C(n)>=t})),r=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),b(e)){var o=this._automationEvents[this._automationEvents.length-1];if(void 0!==r&&v(r)){if(P(o))throw new Error("The internal list is malformed.");var i=y(o)?o.startTime+o.duration:C(o),a=y(o)?o.values[o.values.length-1]:o.value,s=p(r)?A(t,i,a,r):O(t,i,a,r),h=p(r)?u(s,t,this._currenTime):c(s,t,this._currenTime);this._automationEvents.push(h)}void 0!==o&&P(o)&&this._automationEvents.push(l(this.getValue(t),t)),void 0!==o&&y(o)&&o.startTime+o.duration>t&&(this._automationEvents[this._automationEvents.length-1]=d(new Float32Array([6,7]),o.startTime,t-o.startTime))}}else{var m=this._automationEvents.findIndex((function(e){return C(e)>t})),g=-1===m?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[m-1];if(void 0!==g&&y(g)&&C(g)+g.duration>t)return!1;var w=p(e)?u(e.value,e.endTime,this._currenTime):f(e)?c(e.value,t,this._currenTime):e;if(-1===m)this._automationEvents.push(w);else{if(y(e)&&t+e.duration>C(this._automationEvents[m]))return!1;this._automationEvents.splice(m,0,w)}}return!0}},{key:"flush",value:function(e){var t=this._automationEvents.findIndex((function(t){return C(t)>e}));if(t>1){var n=this._automationEvents.slice(t-1),r=n[0];P(r)&&n.unshift(l(g(this._automationEvents,t-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(e){if(0===this._automationEvents.length)return this._defaultValue;var t=this._automationEvents[this._automationEvents.length-1],n=this._automationEvents.findIndex((function(t){return C(t)>e})),r=this._automationEvents[n],o=C(t)<=e?t:this._automationEvents[n-1];if(void 0!==o&&P(o)&&(void 0===r||!v(r)||r.insertTime>e))return h(e,g(this._automationEvents,n-2,o.startTime,this._defaultValue),o);if(void 0!==o&&m(o)&&(void 0===r||!v(r)))return o.value;if(void 0!==o&&y(o)&&(void 0===r||!v(r)||o.startTime+o.duration>e))return e<o.startTime+o.duration?S(e,o):o.values[o.values.length-1];if(void 0!==o&&v(o)&&(void 0===r||!v(r)))return o.value;if(void 0!==r&&p(r)){var a=w(this._automationEvents,n-1,o,r,this._defaultValue),s=i.default(a,2),u=s[0],c=s[1];return A(e,u,c,r)}if(void 0!==r&&f(r)){var l=w(this._automationEvents,n-1,o,r,this._defaultValue),d=i.default(l,2),b=d[0],_=d[1];return O(e,b,_,r)}return this._defaultValue}}]),e}();e.AutomationEventList=x,e.createCancelAndHoldAutomationEvent=function(e){return{cancelTime:e,type:"cancelAndHold"}},e.createCancelScheduledValuesAutomationEvent=function(e){return{cancelTime:e,type:"cancelScheduledValues"}},e.createExponentialRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"exponentialRampToValue",value:e}},e.createLinearRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"linearRampToValue",value:e}},e.createSetTargetAutomationEvent=function(e,t,n){return{startTime:t,target:e,timeConstant:n,type:"setTarget"}},e.createSetValueAutomationEvent=l,e.createSetValueCurveAutomationEvent=d,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(428),n(785),n(919))},915:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},572:function(e){e.exports=function(e){if(Array.isArray(e))return e}},785:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},919:function(e){function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}},617:function(e){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}},600:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},428:function(e,t,n){var r=n(572),o=n(617),i=n(105),a=n(600);e.exports=function(e,t){return r(e)||o(e,t)||i(e,t)||a()}},105:function(e,t,n){var r=n(915);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},43:function(e,t,n){var r,o;!function(i,a){"use strict";void 0===(o="function"==typeof(r=function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function o(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function i(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(r){return"debug"===r&&(r="log"),typeof console!==t&&("trace"===r&&n?i:void 0!==console[r]?o(console,r):void 0!==console.log?o(console,"log"):e)}function s(t,n){for(var o=0;o<r.length;o++){var i=r[o];this[i]=o<t?e:this.methodFactory(i,t,n)}this.log=this.debug}function u(e,n,r){return function(){typeof console!==t&&(s.call(this,n,r),this[e].apply(this,arguments))}}function c(e,t,n){return a(e)||u.apply(this,arguments)}function l(e,n,o){var i,a=this,u="loglevel";function l(){var e;if(typeof window!==t&&u){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var n=window.document.cookie,r=n.indexOf(encodeURIComponent(u)+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=o||c,a.getLevel=function(){return i},a.setLevel=function(n,o){if("string"==typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(i=n,!1!==o&&function(e){var n=(r[e]||"silent").toUpperCase();if(typeof window!==t&&u){try{return void(window.localStorage[u]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+n+";"}catch(e){}}}(n),s.call(a,n,e),typeof console===t&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){l()||a.setLevel(e,!1)},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var d=l();null==d&&(d=null==n?"WARN":n),a.setLevel(d,!1)}var d=new l,h={};d.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=h[e];return t||(t=h[e]=new l(e,d.getLevel(),d.methodFactory)),t};var p=typeof window!==t?window.log:void 0;return d.noConflict=function(){return typeof window!==t&&window.log===d&&(window.log=p),d},d.getLoggers=function(){return h},d.default=d,d})?r.call(t,n,t,e):r)||(e.exports=o)}()},513:function(e,t,n){"use strict";n.r(t),n.d(t,{AnalyserNode:function(){return Dt},AudioBuffer:function(){return Ut},AudioBufferSourceNode:function(){return $t},AudioContext:function(){return Jn},AudioWorkletNode:function(){return dr},BiquadFilterNode:function(){return tn},ChannelMergerNode:function(){return an},ChannelSplitterNode:function(){return sn},ConstantSourceNode:function(){return ln},ConvolverNode:function(){return hn},DelayNode:function(){return pn},DynamicsCompressorNode:function(){return vn},GainNode:function(){return mn},IIRFilterNode:function(){return bn},MediaElementAudioSourceNode:function(){return Zn},MediaStreamAudioDestinationNode:function(){return Hn},MediaStreamAudioSourceNode:function(){return Qn},MediaStreamTrackAudioSourceNode:function(){return $n},MinimalAudioContext:function(){return hr},MinimalOfflineAudioContext:function(){return vr},OfflineAudioContext:function(){return mr},OscillatorNode:function(){return Pn},PannerNode:function(){return kn},PeriodicWave:function(){return Rn},StereoPannerNode:function(){return Ln},WaveShaperNode:function(){return Fn},addAudioWorkletModule:function(){return qn},decodeAudioData:function(){return Yn},isAnyAudioContext:function(){return yr},isAnyAudioNode:function(){return gr},isAnyAudioParam:function(){return wr},isAnyOfflineAudioContext:function(){return br},isSupported:function(){return _r}});var r=n(382);const o=new WeakSet,i=new WeakMap,a=new WeakMap,s=new WeakMap,u=new WeakMap,c=new WeakMap,l=new WeakMap,d=new WeakMap,h=new WeakMap,p=new WeakMap,f={construct:()=>f},v=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,m=(e,t)=>{const n=[];let r=e.replace(/^[\s]+/,""),o=r.match(v);for(;null!==o;){const e=o[1].slice(1,-1),i=o[0].replace(/([\s]+)?;?$/,"").replace(e,new URL(e,t).toString());n.push(i),r=r.slice(o[0].length).replace(/^[\s]+/,""),o=r.match(v)}return[n.join(";"),r]},y=e=>{if(void 0!==e&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},g=e=>{if(!(e=>{try{new new Proxy(e,f)}catch{return!1}return!0})(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!=typeof e.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},w=(e,t)=>{const n=e.get(t);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},b=(e,t)=>{const n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[r]=n;return e.delete(r),r},_=(e,t,n,r)=>{const o=w(e,t),i=b(o,(e=>e[0]===n&&e[1]===r));return 0===o.size&&e.delete(t),i},C=e=>w(l,e),A=e=>{if(o.has(e))throw new Error("The AudioNode is already stored.");o.add(e),C(e).forEach((e=>e(!0)))},O=e=>"port"in e,S=e=>{if(!o.has(e))throw new Error("The AudioNode is not stored.");o.delete(e),C(e).forEach((e=>e(!1)))},P=(e,t)=>{!O(e)&&t.every((e=>0===e.size))&&S(e)},x={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},M=(e,t)=>e.context===t,E=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},I=()=>new DOMException("","IndexSizeError"),T=e=>{var t;e.getChannelData=(t=e.getChannelData,n=>{try{return t.call(e,n)}catch(e){if(12===e.code)throw I();throw e}})},k={numberOfChannels:1},R=-34028234663852886e22,N=-R,D=e=>o.has(e),L={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},j=e=>w(i,e),F=e=>w(s,e),B=(e,t)=>{const{activeInputs:n}=j(e);n.forEach((n=>n.forEach((([n])=>{t.includes(e)||B(n,[...t,e])}))));const r=(e=>"playbackRate"in e)(e)?[e.playbackRate]:O(e)?Array.from(e.parameters.values()):(e=>"frequency"in e&&"gain"in e)(e)?[e.Q,e.detune,e.frequency,e.gain]:(e=>"offset"in e)(e)?[e.offset]:(e=>!("frequency"in e)&&"gain"in e)(e)?[e.gain]:(e=>"detune"in e&&"frequency"in e)(e)?[e.detune,e.frequency]:(e=>"pan"in e)(e)?[e.pan]:[];for(const e of r){const n=F(e);void 0!==n&&n.activeInputs.forEach((([e])=>B(e,t)))}D(e)&&S(e)},W=e=>{B(e.destination,[])},G=e=>void 0===e||"number"==typeof e||"string"==typeof e&&("balanced"===e||"interactive"===e||"playback"===e),U=e=>"context"in e,V=e=>U(e[0]),q=(e,t,n,r)=>{for(const t of e)if(n(t)){if(r)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0},z=(e,t,[n,r],o)=>{q(e,[t,n,r],(e=>e[0]===t&&e[1]===n),o)},Y=(e,[t,n,r],o)=>{const i=e.get(t);void 0===i?e.set(t,new Set([[n,r]])):q(i,[n,r],(e=>e[0]===n),o)},X=e=>"inputs"in e,Z=(e,t,n,r)=>{if(X(t)){const o=t.inputs[r];return e.connect(o,n,0),[o,n,0]}return e.connect(t,n,r),[t,n,r]},H=(e,t,n)=>{for(const r of e)if(r[0]===t&&r[1]===n)return e.delete(r),r;return null},Q=(e,t)=>{if(!C(e).delete(t))throw new Error("Missing the expected event listener.")},$=(e,t,n)=>{const r=w(e,t),o=b(r,(e=>e[0]===n));return 0===r.size&&e.delete(t),o},J=(e,t,n,r)=>{X(t)?e.disconnect(t.inputs[r],n,0):e.disconnect(t,n,r)},K=e=>w(a,e),ee=e=>w(u,e),te=e=>d.has(e),ne=e=>!o.has(e),re=e=>new Promise((t=>{const n=e.createScriptProcessor(256,1,1),r=e.createGain(),o=e.createBuffer(1,2,44100),i=o.getChannelData(0);i[0]=1,i[1]=1;const a=e.createBufferSource();a.buffer=o,a.loop=!0,a.connect(n).connect(e.destination),a.connect(r),a.disconnect(r),n.onaudioprocess=r=>{const o=r.inputBuffer.getChannelData(0);Array.prototype.some.call(o,(e=>1===e))?t(!0):t(!1),a.stop(),n.onaudioprocess=null,a.disconnect(n),n.disconnect(e.destination)},a.start()})),oe=(e,t)=>{const n=new Map;for(const t of e)for(const e of t){const t=n.get(e);n.set(e,void 0===t?1:t+1)}n.forEach(((e,n)=>t(n,e)))},ie=e=>"context"in e,ae=e=>{const t=new Map;var n,r;e.connect=(n=e.connect.bind(e),(e,r=0,o=0)=>{const i=ie(e)?n(e,r,o):n(e,r),a=t.get(e);return void 0===a?t.set(e,[{input:o,output:r}]):a.every((e=>e.input!==o||e.output!==r))&&a.push({input:o,output:r}),i}),e.disconnect=(r=e.disconnect,(n,o,i)=>{if(r.apply(e),void 0===n)t.clear();else if("number"==typeof n)for(const[e,r]of t){const o=r.filter((e=>e.output!==n));0===o.length?t.delete(e):t.set(e,o)}else if(t.has(n))if(void 0===o)t.delete(n);else{const e=t.get(n);if(void 0!==e){const r=e.filter((e=>e.output!==o&&(e.input!==i||void 0===i)));0===r.length?t.delete(n):t.set(n,r)}}for(const[n,r]of t)r.forEach((t=>{ie(n)?e.connect(n,t.output,t.input):e.connect(n,t.output)}))})},se=(e,t,n,r,o)=>{const[i,a]=((e,t,n,r)=>{const{activeInputs:o,passiveInputs:i}=j(t),a=H(o[r],e,n);return null===a?[_(i,e,n,r)[2],!1]:[a[2],!0]})(e,n,r,o);if(null!==i&&(Q(e,i),!a||t||te(e)||J(K(e),K(n),r,o)),D(n)){const{activeInputs:e}=j(n);P(n,e)}},ue=(e,t,n,r)=>{const[o,i]=((e,t,n)=>{const{activeInputs:r,passiveInputs:o}=F(t),i=H(r,e,n);return null===i?[$(o,e,n)[1],!1]:[i[2],!0]})(e,n,r);null!==o&&(Q(e,o),!i||t||te(e)||K(e).disconnect(ee(n),r))};class ce{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach(((n,r)=>e.call(t,n,r,this)))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const le={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function de(e,t,n,r,o){if("function"==typeof e.copyFromChannel)0===t[n].byteLength&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],r,o);else{const i=e.getChannelData(r);if(0===t[n].byteLength)t[n]=i.slice(o,o+128);else{const e=new Float32Array(i.buffer,o*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(e)}}}const he=(e,t,n,r,o)=>{"function"==typeof e.copyToChannel?0!==t[n].byteLength&&e.copyToChannel(t[n],r,o):0!==t[n].byteLength&&e.getChannelData(r).set(t[n],o)},pe=(e,t)=>{const n=[];for(let r=0;r<e;r+=1){const e=[],o="number"==typeof t?t:t[r];for(let t=0;t<o;t+=1)e.push(new Float32Array(128));n.push(e)}return n},fe=async(e,t,n,r,o,i,a)=>{const s=null===t?128*Math.ceil(e.context.length/128):t.length,u=r.channelCount*r.numberOfInputs,c=o.reduce(((e,t)=>e+t),0),l=0===c?null:n.createBuffer(c,s,n.sampleRate);if(void 0===i)throw new Error("Missing the processor constructor.");const d=j(e),h=await((e,t)=>{const n=w(p,e),r=K(t);return w(n,r)})(n,e),f=pe(r.numberOfInputs,r.channelCount),v=pe(r.numberOfOutputs,o),m=Array.from(e.parameters.keys()).reduce(((e,t)=>({...e,[t]:new Float32Array(128)})),{});for(let c=0;c<s;c+=128){if(r.numberOfInputs>0&&null!==t)for(let e=0;e<r.numberOfInputs;e+=1)for(let n=0;n<r.channelCount;n+=1)de(t,f[e],n,n,c);void 0!==i.parameterDescriptors&&null!==t&&i.parameterDescriptors.forEach((({name:e},n)=>{de(t,m,e,u+n,c)}));for(let e=0;e<r.numberOfInputs;e+=1)for(let t=0;t<o[e];t+=1)0===v[e][t].byteLength&&(v[e][t]=new Float32Array(128));try{const e=f.map(((e,t)=>0===d.activeInputs[t].size?[]:e)),t=a(c/n.sampleRate,n.sampleRate,(()=>h.process(e,v,m)));if(null!==l)for(let e=0,t=0;e<r.numberOfOutputs;e+=1){for(let n=0;n<o[e];n+=1)he(l,v[e],n,t+n,c);t+=o[e]}if(!t)break}catch(t){e.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}));break}}return l},ve={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},me={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},ye={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ge={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},we={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},be={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},_e=(e,t,n)=>{const r=t[n];if(void 0===r)throw e();return r},Ce={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Ae={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Oe=()=>new DOMException("","InvalidStateError"),Se=()=>new DOMException("","InvalidAccessError"),Pe={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},xe=(e,t,n,r,o,i,a,s,u,c,l)=>{const d=c.length;let h=s;for(let s=0;s<d;s+=1){let d=n[0]*c[s];for(let t=1;t<o;t+=1){const r=h-t&u-1;d+=n[t]*i[r],d-=e[t]*a[r]}for(let e=o;e<r;e+=1)d+=n[e]*i[h-e&u-1];for(let n=o;n<t;n+=1)d-=e[n]*a[h-n&u-1];i[h]=c[s],a[h]=d,h=h+1&u-1,l[s]=d}return h},Me={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Ee=e=>{const t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=e.decodeAudioData(t.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},Ie={numberOfChannels:1},Te=(e,t,n)=>{const r=t[n];void 0!==r&&r!==e[n]&&(e[n]=r)},ke=(e,t)=>{Te(e,t,"channelCount"),Te(e,t,"channelCountMode"),Te(e,t,"channelInterpretation")},Re=e=>"function"==typeof e.getFloatTimeDomainData,Ne=(e,t,n)=>{const r=t[n];void 0!==r&&r!==e[n].value&&(e[n].value=r)},De=e=>{var t;e.start=(t=e.start,(n=0,r=0,o)=>{if("number"==typeof o&&o<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,r,o)})},Le=e=>{var t;e.stop=(t=e.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})},je=(e,t)=>null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t))))),Fe=(e,t)=>{const n=e.createBiquadFilter();return ke(n,t),Ne(n,t,"Q"),Ne(n,t,"detune"),Ne(n,t,"frequency"),Ne(n,t,"gain"),Te(n,t,"type"),n},Be=(e,t)=>{const n=e.createChannelSplitter(t.numberOfOutputs);return ke(n,t),(e=>{const t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw Oe()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:e=>{if("explicit"!==e)throw Oe()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:e=>{if("discrete"!==e)throw Oe()}})})(n),n},We=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e),Ge=(e,t)=>{const n=e.createDelay(t.maxDelayTime);return ke(n,t),Ne(n,t,"delayTime"),n},Ue=(e,t)=>{const n=e.createGain();return ke(n,t),Ne(n,t,"gain"),n};function Ve(e,t){const n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}function qe(e,t){let n=[0,0];for(let i=e.length-1;i>=0;i-=1)o=t,n=[(r=n)[0]*o[0]-r[1]*o[1],r[0]*o[1]+r[1]*o[0]],n[0]+=e[i];var r,o;return n}const ze=(e,t,n,r)=>e.createScriptProcessor(t,n,r),Ye=()=>new DOMException("","NotSupportedError"),Xe={numberOfChannels:1},Ze={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},He={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Qe={disableNormalization:!1},$e={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Je=()=>new DOMException("","UnknownError"),Ke={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},et=e=>{if(null===e)return!1;const t=e.length;return t%2!=0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0},tt=(e,t,n,r)=>{let o=Object.getPrototypeOf(e);for(;!o.hasOwnProperty(t);)o=Object.getPrototypeOf(o);const{get:i,set:a}=Object.getOwnPropertyDescriptor(o,t);Object.defineProperty(e,t,{get:n(i),set:r(a)})},nt=(e,t,n)=>{try{e.setValueAtTime(t,n)}catch(r){if(9!==r.code)throw r;nt(e,t,n+1e-7)}},rt=e=>{const t=e.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},ot=e=>{const t=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},it=e=>{const t=e.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1},at=()=>{try{new DOMException}catch{return!1}return!0},st=()=>new Promise((e=>{const t=new ArrayBuffer(0),{port1:n,port2:r}=new MessageChannel;n.onmessage=({data:t})=>e(null!==t),r.postMessage(t,[t])})),ut=(e,t)=>{const n=t.createGain();e.connect(n);const r=(o=e.disconnect,()=>{o.call(e,n),e.removeEventListener("ended",r)});var o;e.addEventListener("ended",r),We(e,n),e.stop=(t=>{let r=!1;return(o=0)=>{if(r)try{t.call(e,o)}catch{n.gain.setValueAtTime(0,o)}else t.call(e,o),r=!0}})(e.stop)},ct=(e,t)=>n=>{const r={value:e};return Object.defineProperties(n,{currentTarget:r,target:r}),"function"==typeof t?t.call(e,n):t.handleEvent.call(e,n)},lt=(e=>(t,n,[r,o,i],a)=>{e(t[o],[n,r,i],(e=>e[0]===n&&e[1]===r),a)})(q),dt=(e=>(t,n,[r,o,i],a)=>{const s=t.get(r);void 0===s?t.set(r,new Set([[o,n,i]])):e(s,[o,n,i],(e=>e[0]===o&&e[1]===n),a)})(q),ht=(e=>(t,n,r,o)=>e(t[o],(e=>e[0]===n&&e[1]===r)))(b),pt=new WeakMap,ft=(e=>t=>{var n;return null!==(n=e.get(t))&&void 0!==n?n:0})(pt),vt=(mt=new Map,yt=new WeakMap,(e,t)=>{const n=yt.get(e);if(void 0!==n)return n;const r=mt.get(e);if(void 0!==r)return r;try{const n=t();return n instanceof Promise?(mt.set(e,n),n.catch((()=>!1)).then((t=>(mt.delete(e),yt.set(e,t),t)))):(yt.set(e,n),n)}catch{return yt.set(e,!1),!1}});var mt,yt;const gt="undefined"==typeof window?null:window,wt=((e,t)=>(n,r)=>{const o=n.createAnalyser();if(ke(o,r),!(r.maxDecibels>r.minDecibels))throw t();return Te(o,r,"fftSize"),Te(o,r,"maxDecibels"),Te(o,r,"minDecibels"),Te(o,r,"smoothingTimeConstant"),e(Re,(()=>Re(o)))||(e=>{e.getFloatTimeDomainData=t=>{const n=new Uint8Array(t.length);e.getByteTimeDomainData(n);const r=Math.max(n.length,e.fftSize);for(let e=0;e<r;e+=1)t[e]=.0078125*(n[e]-128);return t}})(o),o})(vt,I),bt=(e=>t=>{const n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(j),_t=((e,t,n)=>async(r,o,i,a)=>{const s=e(r),u=[...a,r];await Promise.all(s.activeInputs.map(((e,a)=>Array.from(e).filter((([e])=>!u.includes(e))).map((async([e,s])=>{const c=t(e),l=await c.render(e,o,u),d=r.context.destination;n(e)||r===d&&n(r)||l.connect(i,s,a)})))).reduce(((e,t)=>[...e,...t]),[]))})(j,bt,te),Ct=((e,t,n)=>()=>{const r=new WeakMap;return{render(o,i,a){const s=r.get(i);return void 0!==s?Promise.resolve(s):(async(o,i,a)=>{let s=t(o);if(!M(s,i)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,fftSize:s.fftSize,maxDecibels:s.maxDecibels,minDecibels:s.minDecibels,smoothingTimeConstant:s.smoothingTimeConstant};s=e(i,t)}return r.set(i,s),await n(o,i,s,a),s})(o,i,a)}}})(wt,K,_t),At=(Ot=c,e=>{const t=Ot.get(e);if(void 0===t)throw Oe();return t});var Ot;const St=(e=>null===e?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null)(gt),Pt=(e=>t=>null!==e&&t instanceof e)(St),xt=new WeakMap,Mt=(e=>class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(t,n,r){if(null!==n){let o=this._listeners.get(n);void 0===o&&(o=e(this,n),"function"==typeof n&&this._listeners.set(n,o)),this._nativeEventTarget.addEventListener(t,o,r)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,n){const r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}})(ct),Et=(e=>null===e?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null)(gt),It=(e=>t=>null!==e&&t instanceof e)(Et),Tt=(e=>t=>null!==e&&"function"==typeof e.AudioNode&&t instanceof e.AudioNode)(gt),kt=(e=>t=>null!==e&&"function"==typeof e.AudioParam&&t instanceof e.AudioParam)(gt),Rt=((e,t,n,r,o,i,s,u,c,d,h,p,f,v,m)=>class extends d{constructor(t,r,o,i){super(o),this._context=t,this._nativeAudioNode=o;const s=h(t);p(s)&&!0!==n(re,(()=>re(s)))&&ae(o),a.set(this,o),l.set(this,new Set),"closed"!==t.state&&r&&A(this),e(this,i,o)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(e){this._nativeAudioNode.channelCount=e}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(e){this._nativeAudioNode.channelCountMode=e}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(e){this._nativeAudioNode.channelInterpretation=e}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(e,n=0,a=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw o();const u=h(this._context),l=m(u);if(f(e)||v(e))throw i();if(U(e)){const o=K(e);try{const t=Z(this._nativeAudioNode,o,n,a),r=ne(this);(l||r)&&this._nativeAudioNode.disconnect(...t),"closed"!==this.context.state&&!r&&ne(e)&&A(e)}catch(e){if(12===e.code)throw i();throw e}if(t(this,e,n,a,l)){const t=c([this],e);oe(t,r(l))}return e}const d=ee(e);if("playbackRate"===d.name)throw s();try{this._nativeAudioNode.connect(d,n),(l||ne(this))&&this._nativeAudioNode.disconnect(d,n)}catch(e){if(12===e.code)throw i();throw e}if(((e,t,n,r)=>{const{activeInputs:o,passiveInputs:i}=F(t),{outputs:a}=j(e),s=C(e),u=a=>{const s=K(e),u=ee(t);if(a){const t=$(i,e,n);z(o,e,t,!1),r||te(e)||s.connect(u,n)}else{const t=((e,t,n)=>b(e,(e=>e[0]===t&&e[1]===n)))(o,e,n);Y(i,t,!1),r||te(e)||s.disconnect(u,n)}};return!!q(a,[t,n],(e=>e[0]===t&&e[1]===n),!0)&&(s.add(u),D(e)?z(o,e,[n,u],!0):Y(i,[e,n,u],!0),!0)})(this,e,n,l)){const t=c([this],e);oe(t,r(l))}}disconnect(e,t,n){let r;const a=h(this._context),s=m(a);if(void 0===e)r=((e,t)=>{const n=j(e),r=[];for(const o of n.outputs)V(o)?se(e,t,...o):ue(e,t,...o),r.push(o[0]);return n.outputs.clear(),r})(this,s);else if("number"==typeof e){if(e<0||e>=this.numberOfOutputs)throw o();r=((e,t,n)=>{const r=j(e),o=[];for(const i of r.outputs)i[1]===n&&(V(i)?se(e,t,...i):ue(e,t,...i),o.push(i[0]),r.outputs.delete(i));return o})(this,s,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs))throw o();if(U(e)&&void 0!==n&&(n<0||n>=e.numberOfInputs))throw o();if(r=((e,t,n,r,o)=>{const i=j(e);return Array.from(i.outputs).filter((e=>!(e[0]!==n||void 0!==r&&e[1]!==r||void 0!==o&&e[2]!==o))).map((n=>(V(n)?se(e,t,...n):ue(e,t,...n),i.outputs.delete(n),n[0])))})(this,s,e,t,n),0===r.length)throw i()}for(const e of r){const t=c([this],e);oe(t,u)}}})((Nt=i,(e,t,n)=>{const r=[];for(let e=0;e<n.numberOfInputs;e+=1)r.push(new Set);Nt.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:t})}),((e,t,n,r,o,i,a,s,u,c,l,d,h)=>(p,f,v,m,y)=>{const{activeInputs:g,passiveInputs:w}=i(f),{outputs:b}=i(p),C=s(p),O=i=>{const s=u(f),c=u(p);if(i){const t=_(w,p,v,m);e(g,p,t,!1),y||d(p)||n(c,s,v,m),h(f)&&A(f)}else{const e=r(g,p,v,m);t(w,m,e,!1),y||d(p)||o(c,s,v,m);const n=a(f);0===n?l(f)&&P(f,g):setTimeout((()=>{l(f)&&P(f,g)}),1e3*n)}};return!!c(b,[f,v,m],(e=>e[0]===f&&e[1]===v&&e[2]===m),!0)&&(C.add(O),l(p)?e(g,p,[v,m,O],!0):t(w,m,[p,v,O],!0),!0)})(lt,dt,Z,ht,J,j,ft,C,K,q,D,te,ne),vt,((e,t,n,r,o,i)=>a=>(s,u)=>{const c=e.get(s);if(void 0===c){if(!a&&i(s)){const e=r(s),{outputs:i}=n(s);for(const n of i)if(V(n)){const o=r(n[0]);t(e,o,n[1],n[2])}else{const t=o(n[0]);e.disconnect(t,n[1])}}e.set(s,u)}else e.set(s,c+u)})(d,J,j,K,ee,D),I,Se,Ye,((e,t,n,r,o,i,a,s)=>(u,c)=>{const l=t.get(u);if(void 0===l)throw new Error("Missing the expected cycle count.");const d=i(u.context),h=s(d);if(l===c){if(t.delete(u),!h&&a(u)){const t=r(u),{outputs:i}=n(u);for(const n of i)if(V(n)){const o=r(n[0]);e(t,o,n[1],n[2])}else{const e=o(n[0]);t.connect(e,n[1])}}}else t.set(u,l-c)})(Z,d,j,K,ee,At,D,Pt),((e,t,n)=>function r(o,i){const a=U(i)?i:n(e,i);if((e=>"delayTime"in e)(a))return[];if(o[0]===a)return[o];if(o.includes(a))return[];const{outputs:s}=t(a);return Array.from(s).map((e=>r([...o,a],e[0]))).reduce(((e,t)=>e.concat(t)),[])})(xt,j,w),Mt,At,It,Tt,kt,Pt);var Nt;const Dt=((e,t,n,r,o,i)=>class extends e{constructor(e,n){const a=o(e),s={...x,...n},u=r(a,s);super(e,!1,u,i(a)?t():null),this._nativeAnalyserNode=u}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(e){this._nativeAnalyserNode.fftSize=e}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(e){const t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(e){const t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(e){this._nativeAnalyserNode.smoothingTimeConstant=e}getByteFrequencyData(e){this._nativeAnalyserNode.getByteFrequencyData(e)}getByteTimeDomainData(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}getFloatFrequencyData(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}getFloatTimeDomainData(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}})(Rt,Ct,I,wt,At,Pt),Lt=new WeakSet,jt=(e=>null===e?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null)(gt),Ft=(Bt=new Uint32Array(1),e=>(Bt[0]=e,Bt[0]));var Bt;const Wt=((e,t)=>n=>{n.copyFromChannel=(r,o,i=0)=>{const a=e(i),s=e(o);if(s>=n.numberOfChannels)throw t();const u=n.length,c=n.getChannelData(s),l=r.length;for(let e=a<0?-a:0;e+a<u&&e<l;e+=1)r[e]=c[e+a]},n.copyToChannel=(r,o,i=0)=>{const a=e(i),s=e(o);if(s>=n.numberOfChannels)throw t();const u=n.length,c=n.getChannelData(s),l=r.length;for(let e=a<0?-a:0;e+a<u&&e<l;e+=1)c[e+a]=r[e]}})(Ft,I),Gt=(e=>t=>{t.copyFromChannel=(n=>(r,o,i=0)=>{const a=e(i),s=e(o);if(a<t.length)return n.call(t,r,s,a)})(t.copyFromChannel),t.copyToChannel=(n=>(r,o,i=0)=>{const a=e(i),s=e(o);if(a<t.length)return n.call(t,r,s,a)})(t.copyToChannel)})(Ft),Ut=((e,t,n,r,o,i,a,s)=>{let u=null;return class c{constructor(c){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:d,sampleRate:h}={...k,...c};null===u&&(u=new o(1,1,44100));const p=null!==r&&t(i,i)?new r({length:l,numberOfChannels:d,sampleRate:h}):u.createBuffer(d,l,h);if(0===p.numberOfChannels)throw n();return"function"!=typeof p.copyFromChannel?(a(p),T(p)):t(E,(()=>E(p)))||s(p),e.add(p),p}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===c.prototype||e.has(t)}}})(Lt,vt,Ye,jt,St,(e=>()=>{if(null===e)return!1;try{new e({length:1,sampleRate:44100})}catch{return!1}return!0})(jt),Wt,Gt),Vt=(e=>(t,n)=>{const r=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(t.destination);const o=()=>{n.removeEventListener("ended",o),n.disconnect(r),r.disconnect()};n.addEventListener("ended",o)})(Ue),qt=((e,t,n)=>async(r,o,i,a)=>{const s=t(r);await Promise.all(Array.from(s.activeInputs).map((async([t,r])=>{const s=e(t),u=await s.render(t,o,a);n(t)||u.connect(i,r)})))})(bt,F,te),zt=(e=>(t,n,r,o)=>e(n,t,r,o))(qt),Yt=((e,t,n,r,o,i,a,s,u,c,l)=>(u,d)=>{const h=u.createBufferSource();return ke(h,d),Ne(h,d,"playbackRate"),Te(h,d,"buffer"),Te(h,d,"loop"),Te(h,d,"loopEnd"),Te(h,d,"loopStart"),t(n,(()=>n(u)))||(e=>{e.start=(t=>{let n=!1;return(r=0,o=0,i)=>{if(n)throw Oe();t.call(e,r,o,i),n=!0}})(e.start)})(h),t(r,(()=>r(u)))||(e=>{var t;e.start=(t=e.start,(n=0,r=0,o)=>{const i=e.buffer,a=null===i?r:Math.min(i.duration,r);null!==i&&a>i.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,a,o)})})(h),t(o,(()=>o(u)))||c(h,u),t(i,(()=>i(u)))||De(h),t(a,(()=>a(u)))||l(h,u),t(s,(()=>s(u)))||Le(h),e(u,h),h})(Vt,vt,(e=>{const t=e.createBufferSource();t.start();try{t.start()}catch{return!0}return!1}),(e=>{const t=e.createBufferSource(),n=e.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch{return!1}return!0}),(e=>{const t=e.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0}),rt,ot,it,0,(e=>(t,n)=>{const r=n.createBuffer(1,1,44100);null===t.buffer&&(t.buffer=r),e(t,"buffer",(e=>()=>{const n=e.call(t);return n===r?null:n}),(e=>n=>e.call(t,null===n?r:n)))})(tt),ut),Xt=((e,t)=>(n,r,o,i)=>(e(r).replay(o),t(r,n,o,i)))((e=>t=>{const n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(F),qt),Zt=((e,t,n,r,o)=>()=>{const i=new WeakMap;let a=null,s=null;return{set start(e){a=e},set stop(e){s=e},render(u,c,l){const d=i.get(c);return void 0!==d?Promise.resolve(d):(async(u,c,l)=>{let d=n(u);const h=M(d,c);if(!h){const e={buffer:d.buffer,channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,loop:d.loop,loopEnd:d.loopEnd,loopStart:d.loopStart,playbackRate:d.playbackRate.value};d=t(c,e),null!==a&&d.start(...a),null!==s&&d.stop(s)}return i.set(c,d),h?await e(c,u.playbackRate,d.playbackRate,l):await r(c,u.playbackRate,d.playbackRate,l),await o(u,c,d,l),d})(u,c,l)}}})(zt,Yt,K,Xt,_t),Ht=((e,t,n,o,i,a,s,u,c,l,d,h,p)=>(o,f,v,m=null,y=null)=>{const g=new r.AutomationEventList(v.defaultValue),w=f?(e=>({replay(t){for(const n of e)if("exponentialRampToValue"===n.type){const{endTime:e,value:r}=n;t.exponentialRampToValueAtTime(r,e)}else if("linearRampToValue"===n.type){const{endTime:e,value:r}=n;t.linearRampToValueAtTime(r,e)}else if("setTarget"===n.type){const{startTime:e,target:r,timeConstant:o}=n;t.setTargetAtTime(r,e,o)}else if("setValue"===n.type){const{startTime:e,value:r}=n;t.setValueAtTime(r,e)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:e,startTime:r,values:o}=n;t.setValueCurveAtTime(o,r,e)}}}}))(g):null,b={get defaultValue(){return v.defaultValue},get maxValue(){return null===m?v.maxValue:m},get minValue(){return null===y?v.minValue:y},get value(){return v.value},set value(e){v.value=e,b.setValueAtTime(e,o.context.currentTime)},cancelAndHoldAtTime(e){if("function"==typeof v.cancelAndHoldAtTime)null===w&&g.flush(o.context.currentTime),g.add(i(e)),v.cancelAndHoldAtTime(e);else{const t=Array.from(g).pop();null===w&&g.flush(o.context.currentTime),g.add(i(e));const n=Array.from(g).pop();v.cancelScheduledValues(e),t!==n&&void 0!==n&&("exponentialRampToValue"===n.type?v.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?v.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?v.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&v.setValueCurveAtTime(n.values,n.startTime,n.duration))}return b},cancelScheduledValues:e=>(null===w&&g.flush(o.context.currentTime),g.add(a(e)),v.cancelScheduledValues(e),b),exponentialRampToValueAtTime(e,t){if(0===e)throw new RangeError;if(!Number.isFinite(t)||t<0)throw new RangeError;return null===w&&g.flush(o.context.currentTime),g.add(s(e,t)),v.exponentialRampToValueAtTime(e,t),b},linearRampToValueAtTime:(e,t)=>(null===w&&g.flush(o.context.currentTime),g.add(u(e,t)),v.linearRampToValueAtTime(e,t),b),setTargetAtTime:(e,t,n)=>(null===w&&g.flush(o.context.currentTime),g.add(c(e,t,n)),v.setTargetAtTime(e,t,n),b),setValueAtTime:(e,t)=>(null===w&&g.flush(o.context.currentTime),g.add(l(e,t)),v.setValueAtTime(e,t),b),setValueCurveAtTime(e,t,n){const r=e instanceof Float32Array?e:new Float32Array(e);if(null!==h&&"webkitAudioContext"===h.name){const e=t+n,i=o.context.sampleRate,a=Math.ceil(t*i),s=Math.floor(e*i),u=s-a,c=new Float32Array(u);for(let e=0;e<u;e+=1){const o=(r.length-1)/n*((a+e)/i-t),s=Math.floor(o),u=Math.ceil(o);c[e]=s===u?r[s]:(1-(o-s))*r[s]+(1-(u-o))*r[u]}null===w&&g.flush(o.context.currentTime),g.add(d(c,t,n)),v.setValueCurveAtTime(c,t,n);const l=s/i;l<e&&p(b,c[c.length-1],l),p(b,r[r.length-1],e)}else null===w&&g.flush(o.context.currentTime),g.add(d(r,t,n)),v.setValueCurveAtTime(r,t,n);return b}};return n.set(b,v),t.set(b,o),e(b,w),b})((Qt=s,(e,t)=>{Qt.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})}),xt,u,0,r.createCancelAndHoldAutomationEvent,r.createCancelScheduledValuesAutomationEvent,r.createExponentialRampToValueAutomationEvent,r.createLinearRampToValueAutomationEvent,r.createSetTargetAutomationEvent,r.createSetValueAutomationEvent,r.createSetValueCurveAutomationEvent,Et,nt);var Qt;const $t=((e,t,n,r,o,i,a,s)=>class extends e{constructor(e,r){const s=i(e),u={...L,...r},c=o(s,u),l=a(s),d=l?t():null;super(e,!1,c,d),this._audioBufferSourceNodeRenderer=d,this._isBufferNullified=!1,this._isBufferSet=null!==u.buffer,this._nativeAudioBufferSourceNode=c,this._onended=null,this._playbackRate=n(this,l,c.playbackRate,N,R)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(e){if(this._nativeAudioBufferSourceNode.buffer=e,null!==e){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(e){this._nativeAudioBufferSourceNode.loop=e}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(e){this._nativeAudioBufferSourceNode.loopEnd=e}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(e){this._nativeAudioBufferSourceNode.loopStart=e}get onended(){return this._onended}set onended(e){const t="function"==typeof e?s(this,e):null;this._nativeAudioBufferSourceNode.onended=t;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===t?e:n}get playbackRate(){return this._playbackRate}start(e=0,t=0,n){if(this._nativeAudioBufferSourceNode.start(e,t,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[e,t]:[e,t,n]),"closed"!==this.context.state){A(this);const e=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",e),D(this)&&S(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}})(Rt,Zt,Ht,Oe,Yt,At,Pt,ct),Jt=((e,t,n,r,o,i,a,s)=>class extends e{constructor(e,t){const n=i(e),r=a(n),u=o(n,t,r);super(e,!1,u,r?(e=>{let t=null;return{render:(n,r,o)=>(null===t&&(t=(async(t,n,r)=>{const o=n.destination;return await e(t,n,o,r),o})(n,r,o)),t)}})(s):null),this._isNodeOfNativeOfflineAudioContext=r,this._nativeAudioDestinationNode=u}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(e){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=e}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(e){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=e}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(Rt,0,I,Oe,((e,t)=>(n,r,o)=>{const i=n.destination;if(i.channelCount!==r)try{i.channelCount=r}catch{}o&&"explicit"!==i.channelCountMode&&(i.channelCountMode="explicit"),0===i.maxChannelCount&&Object.defineProperty(i,"maxChannelCount",{value:r});const a=e(n,{channelCount:r,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return t(a,"channelCount",(e=>()=>e.call(a)),(e=>t=>{e.call(a,t);try{i.channelCount=t}catch(e){if(t>i.maxChannelCount)throw e}})),t(a,"channelCountMode",(e=>()=>e.call(a)),(e=>t=>{e.call(a,t),i.channelCountMode=t})),t(a,"channelInterpretation",(e=>()=>e.call(a)),(e=>t=>{e.call(a,t),i.channelInterpretation=t})),Object.defineProperty(a,"maxChannelCount",{get:()=>i.maxChannelCount}),a.connect(i),a})(Ue,tt),At,Pt,_t),Kt=((e,t,n,r,o)=>()=>{const i=new WeakMap;return{render(a,s,u){const c=i.get(s);return void 0!==c?Promise.resolve(c):(async(a,s,u)=>{let c=n(a);const l=M(c,s);if(!l){const e={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=t(s,e)}return i.set(s,c),l?(await e(s,a.Q,c.Q,u),await e(s,a.detune,c.detune,u),await e(s,a.frequency,c.frequency,u),await e(s,a.gain,c.gain,u)):(await r(s,a.Q,c.Q,u),await r(s,a.detune,c.detune,u),await r(s,a.frequency,c.frequency,u),await r(s,a.gain,c.gain,u)),await o(a,s,c,u),c})(a,s,u)}}})(zt,Fe,K,Xt,_t),en=(e=>(t,n)=>e.set(t,n))(pt),tn=((e,t,n,r,o,i,a,s)=>class extends e{constructor(e,r){const u=i(e),c={...ve,...r},l=o(u,c),d=a(u);super(e,!1,l,d?n():null),this._Q=t(this,d,l.Q,N,R),this._detune=t(this,d,l.detune,1200*Math.log2(N),-1200*Math.log2(N)),this._frequency=t(this,d,l.frequency,e.sampleRate/2,0),this._gain=t(this,d,l.gain,40*Math.log10(N),R),this._nativeBiquadFilterNode=l,s(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(e){this._nativeBiquadFilterNode.type=e}getFrequencyResponse(e,t,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(e,t,n)}catch(e){if(11===e.code)throw r();throw e}if(e.length!==t.length||t.length!==n.length)throw r()}})(Rt,Ht,Kt,Se,Fe,At,Pt,en),nn=((e,t)=>(n,r,o)=>{const i=new Set;var a,s;return n.connect=(a=n.connect,(o,s=0,u=0)=>{const c=0===i.size;if(t(o))return a.call(n,o,s,u),e(i,[o,s,u],(e=>e[0]===o&&e[1]===s&&e[2]===u),!0),c&&r(),o;a.call(n,o,s),e(i,[o,s],(e=>e[0]===o&&e[1]===s),!0),c&&r()}),n.disconnect=(s=n.disconnect,(e,r,a)=>{const u=i.size>0;if(void 0===e)s.apply(n),i.clear();else if("number"==typeof e){s.call(n,e);for(const t of i)t[1]===e&&i.delete(t)}else{t(e)?s.call(n,e,r,a):s.call(n,e,r);for(const t of i)t[0]!==e||void 0!==r&&t[1]!==r||void 0!==a&&t[2]!==a||i.delete(t)}const c=0===i.size;u&&c&&o()}),n})(q,Tt),rn=((e,t)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw e()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw e()}});const o=n.createBufferSource();t(r,(()=>{const e=r.numberOfInputs;for(let t=0;t<e;t+=1)o.connect(r,0,t)}),(()=>o.disconnect(r)))})(Oe,nn),on=((e,t)=>(n,r)=>{const o=n.createChannelMerger(r.numberOfInputs);return null!==e&&"webkitAudioContext"===e.name&&t(n,o),ke(o,r),o})(Et,rn),an=((e,t,n,r,o)=>class extends e{constructor(e,i){const a=r(e),s={...me,...i};super(e,!1,n(a,s),o(a)?t():null)}})(Rt,((e,t,n)=>()=>{const r=new WeakMap;return{render(o,i,a){const s=r.get(i);return void 0!==s?Promise.resolve(s):(async(o,i,a)=>{let s=t(o);if(!M(s,i)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfInputs:s.numberOfInputs};s=e(i,t)}return r.set(i,s),await n(o,i,s,a),s})(o,i,a)}}})(on,K,_t),on,At,Pt),sn=((e,t,n,r,o,i)=>class extends e{constructor(e,i){const a=r(e),s=(e=>({...e,channelCount:e.numberOfOutputs}))({...ye,...i});super(e,!1,n(a,s),o(a)?t():null)}})(Rt,((e,t,n)=>()=>{const r=new WeakMap;return{render(o,i,a){const s=r.get(i);return void 0!==s?Promise.resolve(s):(async(o,i,a)=>{let s=t(o);if(!M(s,i)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,numberOfOutputs:s.numberOfOutputs};s=e(i,t)}return r.set(i,s),await n(o,i,s,a),s})(o,i,a)}}})(Be,K,_t),Be,At,Pt),un=((e,t,n,r)=>(o,{offset:i,...a})=>{const s=o.createBuffer(1,2,44100),u=t(o,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=n(o,{...a,gain:i}),l=s.getChannelData(0);l[0]=1,l[1]=1,u.buffer=s,u.loop=!0;const d={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(e){c.channelCount=e},get channelCountMode(){return c.channelCountMode},set channelCountMode(e){c.channelCountMode=e},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(e){c.channelInterpretation=e},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return u.onended},set onended(e){u.onended=e},addEventListener:(...e)=>u.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>u.dispatchEvent(e[0]),removeEventListener:(...e)=>u.removeEventListener(e[0],e[1],e[2]),start(e=0){u.start.call(u,e)},stop(e=0){u.stop.call(u,e)}};return e(o,u),r(We(d,c),(()=>u.connect(c)),(()=>u.disconnect(c)))})(Vt,Yt,Ue,nn),cn=((e,t,n,r,o)=>(i,a)=>{if(void 0===i.createConstantSource)return n(i,a);const s=i.createConstantSource();return ke(s,a),Ne(s,a,"offset"),t(r,(()=>r(i)))||De(s),t(o,(()=>o(i)))||Le(s),e(i,s),s})(Vt,vt,un,rt,it),ln=((e,t,n,r,o,i,a)=>class extends e{constructor(e,a){const s=o(e),u={...ge,...a},c=r(s,u),l=i(s),d=l?n():null;super(e,!1,c,d),this._constantSourceNodeRenderer=d,this._nativeConstantSourceNode=c,this._offset=t(this,l,c.offset,N,R),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(e){const t="function"==typeof e?a(this,e):null;this._nativeConstantSourceNode.onended=t;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===t?e:n}start(e=0){if(this._nativeConstantSourceNode.start(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=e),"closed"!==this.context.state){A(this);const e=()=>{this._nativeConstantSourceNode.removeEventListener("ended",e),D(this)&&S(this)};this._nativeConstantSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}})(Rt,Ht,((e,t,n,r,o)=>()=>{const i=new WeakMap;let a=null,s=null;return{set start(e){a=e},set stop(e){s=e},render(u,c,l){const d=i.get(c);return void 0!==d?Promise.resolve(d):(async(u,c,l)=>{let d=n(u);const h=M(d,c);if(!h){const e={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,offset:d.offset.value};d=t(c,e),null!==a&&d.start(a),null!==s&&d.stop(s)}return i.set(c,d),h?await e(c,u.offset,d.offset,l):await r(c,u.offset,d.offset,l),await o(u,c,d,l),d})(u,c,l)}}})(zt,cn,K,Xt,_t),cn,At,Pt,ct),dn=((e,t)=>(n,r)=>{const o=n.createConvolver();if(ke(o,r),r.disableNormalization===o.normalize&&(o.normalize=!r.disableNormalization),Te(o,r,"buffer"),r.channelCount>2)throw e();if(t(o,"channelCount",(e=>()=>e.call(o)),(t=>n=>{if(n>2)throw e();return t.call(o,n)})),"max"===r.channelCountMode)throw e();return t(o,"channelCountMode",(e=>()=>e.call(o)),(t=>n=>{if("max"===n)throw e();return t.call(o,n)})),o})(Ye,tt),hn=((e,t,n,r,o,i)=>class extends e{constructor(e,a){const s=r(e),u={...we,...a},c=n(s,u);super(e,!1,c,o(s)?t():null),this._isBufferNullified=!1,this._nativeConvolverNode=c,null!==u.buffer&&i(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){const e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,44100),this._isBufferNullified=!0,i(this,0)}else this._isBufferNullified=!1,i(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(e){this._nativeConvolverNode.normalize=e}})(Rt,((e,t,n)=>()=>{const r=new WeakMap;return{render(o,i,a){const s=r.get(i);return void 0!==s?Promise.resolve(s):(async(o,i,a)=>{let s=t(o);if(!M(s,i)){const t={buffer:s.buffer,channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,disableNormalization:!s.normalize};s=e(i,t)}return r.set(i,s),X(s)?await n(o,i,s.inputs[0],a):await n(o,i,s,a),s})(o,i,a)}}})(dn,K,_t),dn,At,Pt,en),pn=((e,t,n,r,o,i,a)=>class extends e{constructor(e,s){const u=o(e),c={...be,...s},l=r(u,c),d=i(u);super(e,!1,l,d?n(c.maxDelayTime):null),this._delayTime=t(this,d,l.delayTime),a(this,c.maxDelayTime)}get delayTime(){return this._delayTime}})(Rt,Ht,((e,t,n,r,o)=>i=>{const a=new WeakMap;return{render(s,u,c){const l=a.get(u);return void 0!==l?Promise.resolve(l):(async(s,u,c)=>{let l=n(s);const d=M(l,u);if(!d){const e={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,delayTime:l.delayTime.value,maxDelayTime:i};l=t(u,e)}return a.set(u,l),d?await e(u,s.delayTime,l.delayTime,c):await r(u,s.delayTime,l.delayTime,c),await o(s,u,l,c),l})(s,u,c)}}})(zt,Ge,K,Xt,_t),Ge,At,Pt,en),fn=(e=>(t,n)=>{const r=t.createDynamicsCompressor();if(ke(r,n),n.channelCount>2)throw e();if("max"===n.channelCountMode)throw e();return Ne(r,n,"attack"),Ne(r,n,"knee"),Ne(r,n,"ratio"),Ne(r,n,"release"),Ne(r,n,"threshold"),r})(Ye),vn=((e,t,n,r,o,i,a,s)=>class extends e{constructor(e,o){const u=i(e),c={...Ce,...o},l=r(u,c),d=a(u);super(e,!1,l,d?n():null),this._attack=t(this,d,l.attack),this._knee=t(this,d,l.knee),this._nativeDynamicsCompressorNode=l,this._ratio=t(this,d,l.ratio),this._release=t(this,d,l.release),this._threshold=t(this,d,l.threshold),s(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(e){const t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,o()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(e){const t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,o()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(Rt,Ht,((e,t,n,r,o)=>()=>{const i=new WeakMap;return{render(a,s,u){const c=i.get(s);return void 0!==c?Promise.resolve(c):(async(a,s,u)=>{let c=n(a);const l=M(c,s);if(!l){const e={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=t(s,e)}return i.set(s,c),l?(await e(s,a.attack,c.attack,u),await e(s,a.knee,c.knee,u),await e(s,a.ratio,c.ratio,u),await e(s,a.release,c.release,u),await e(s,a.threshold,c.threshold,u)):(await r(s,a.attack,c.attack,u),await r(s,a.knee,c.knee,u),await r(s,a.ratio,c.ratio,u),await r(s,a.release,c.release,u),await r(s,a.threshold,c.threshold,u)),await o(a,s,c,u),c})(a,s,u)}}})(zt,fn,K,Xt,_t),fn,Ye,At,Pt,en),mn=((e,t,n,r,o,i)=>class extends e{constructor(e,a){const s=o(e),u={...Ae,...a},c=r(s,u),l=i(s);super(e,!1,c,l?n():null),this._gain=t(this,l,c.gain,N,R)}get gain(){return this._gain}})(Rt,Ht,((e,t,n,r,o)=>()=>{const i=new WeakMap;return{render(a,s,u){const c=i.get(s);return void 0!==c?Promise.resolve(c):(async(a,s,u)=>{let c=n(a);const l=M(c,s);if(!l){const e={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=t(s,e)}return i.set(s,c),l?await e(s,a.gain,c.gain,u):await r(s,a.gain,c.gain,u),await o(a,s,c,u),c})(a,s,u)}}})(zt,Ue,K,Xt,_t),Ue,At,Pt),yn=((e,t,n,r)=>(o,i,{channelCount:a,channelCountMode:s,channelInterpretation:u,feedback:c,feedforward:l})=>{const d=je(i,o.sampleRate),h=c instanceof Float64Array?c:new Float64Array(c),p=l instanceof Float64Array?l:new Float64Array(l),f=h.length,v=p.length,m=Math.min(f,v);if(0===f||f>20)throw r();if(0===h[0])throw t();if(0===v||v>20)throw r();if(0===p[0])throw t();if(1!==h[0]){for(let e=0;e<v;e+=1)p[e]/=h[0];for(let e=1;e<f;e+=1)h[e]/=h[0]}const y=n(o,d,a,a);y.channelCount=a,y.channelCountMode=s,y.channelInterpretation=u;const g=[],w=[],b=[];for(let e=0;e<a;e+=1){g.push(0);const e=new Float32Array(32),t=new Float32Array(32);e.fill(0),t.fill(0),w.push(e),b.push(t)}y.onaudioprocess=e=>{const t=e.inputBuffer,n=e.outputBuffer,r=t.numberOfChannels;for(let e=0;e<r;e+=1){const r=t.getChannelData(e),o=n.getChannelData(e);g[e]=xe(h,f,p,v,m,w[e],b[e],g[e],32,r,o)}};const _=o.sampleRate/2;return We({get bufferSize(){return d},get channelCount(){return y.channelCount},set channelCount(e){y.channelCount=e},get channelCountMode(){return y.channelCountMode},set channelCountMode(e){y.channelCountMode=e},get channelInterpretation(){return y.channelInterpretation},set channelInterpretation(e){y.channelInterpretation=e},get context(){return y.context},get inputs(){return[y]},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},addEventListener:(...e)=>y.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>y.dispatchEvent(e[0]),getFrequencyResponse(t,n,r){if(t.length!==n.length||n.length!==r.length)throw e();const o=t.length;for(let e=0;e<o;e+=1){const o=-Math.PI*(t[e]/_),i=[Math.cos(o),Math.sin(o)],a=Ve(qe(p,i),qe(h,i));n[e]=Math.sqrt(a[0]*a[0]+a[1]*a[1]),r[e]=Math.atan2(a[1],a[0])}},removeEventListener:(...e)=>y.removeEventListener(e[0],e[1],e[2])},y)})(Se,Oe,ze,Ye),gn=((e,t,n,r)=>o=>e(Ee,(()=>Ee(o)))?Promise.resolve(e(r,r)).then((e=>{if(!e){const e=n(o,512,0,1);o.oncomplete=()=>{e.onaudioprocess=null,e.disconnect()},e.onaudioprocess=()=>o.currentTime,e.connect(o.destination)}return o.startRendering()})):new Promise((e=>{const n=t(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});o.oncomplete=t=>{n.disconnect(),e(t.renderedBuffer)},n.connect(o.destination),o.startRendering()})))(vt,Ue,ze,((e,t)=>()=>{if(null===t)return Promise.resolve(!1);const n=new t(1,1,44100),r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((e=>{n.oncomplete=()=>{r.disconnect(),e(0!==n.currentTime)},n.startRendering()}))})(Ue,St)),wn=((e,t,n,r,o)=>(i,a)=>{const s=new WeakMap;let u=null;return{render(c,l,d){const h=s.get(l);return void 0!==h?Promise.resolve(h):(async(c,l,d)=>{let h=null,p=t(c);const f=M(p,l);if(void 0===l.createIIRFilter?h=e(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(p=l.createIIRFilter(a,i)),s.set(l,null===h?p:h),null!==h){if(null===u){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const e=new n(c.context.destination.channelCount,c.context.length,l.sampleRate);u=(async()=>(await r(c,e,e.destination,d),((e,t,n,r)=>{const o=n instanceof Float64Array?n:new Float64Array(n),i=r instanceof Float64Array?r:new Float64Array(r),a=o.length,s=i.length,u=Math.min(a,s);if(1!==o[0]){for(let e=0;e<a;e+=1)i[e]/=o[0];for(let e=1;e<s;e+=1)o[e]/=o[0]}const c=new Float32Array(32),l=new Float32Array(32),d=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),h=e.numberOfChannels;for(let t=0;t<h;t+=1){const n=e.getChannelData(t),r=d.getChannelData(t);c.fill(0),l.fill(0),xe(o,a,i,s,u,c,l,0,32,n,r)}return d})(await o(e),l,i,a)))()}const e=await u;return h.buffer=e,h.start(0),h}return await r(c,l,p,d),p})(c,l,d)}}})(Yt,K,St,_t,gn),bn=((e,t,n,r,o,i)=>class extends e{constructor(e,a){const s=r(e),u=o(s),c={...Pe,...a},l=t(s,u?null:e.baseLatency,c);super(e,!1,l,u?n(c.feedback,c.feedforward):null),(e=>{var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,(n,r,o)=>{if(n.length!==r.length||r.length!==o.length)throw Se();return t.call(e,n,r,o)})})(l),this._nativeIIRFilterNode=l,i(this,1)}getFrequencyResponse(e,t,n){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,n)}})(Rt,(e=>(t,n,r)=>{if(void 0===t.createIIRFilter)return e(t,n,r);const o=t.createIIRFilter(r.feedforward,r.feedback);return ke(o,r),o})(yn),wn,At,Pt,en),_n=((e,t,n,r,o)=>(i,a)=>{const s=a.listener,{forwardX:u,forwardY:c,forwardZ:l,positionX:d,positionY:h,positionZ:p,upX:f,upY:v,upZ:m}=void 0===s.forwardX?(()=>{const u=t(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),c=o(a),l=r(a,256,9,0),d=(t,r)=>{const o=n(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:r});return o.connect(u,0,t),o.start(),Object.defineProperty(o.offset,"defaultValue",{get:()=>r}),e({context:i},c,o.offset,N,R)};let h=[0,0,-1,0,1,0],p=[0,0,0];return l.onaudioprocess=({inputBuffer:e})=>{const t=[e.getChannelData(0)[0],e.getChannelData(1)[0],e.getChannelData(2)[0],e.getChannelData(3)[0],e.getChannelData(4)[0],e.getChannelData(5)[0]];t.some(((e,t)=>e!==h[t]))&&(s.setOrientation(...t),h=t);const n=[e.getChannelData(6)[0],e.getChannelData(7)[0],e.getChannelData(8)[0]];n.some(((e,t)=>e!==p[t]))&&(s.setPosition(...n),p=n)},u.connect(l),{forwardX:d(0,0),forwardY:d(1,0),forwardZ:d(2,-1),positionX:d(6,0),positionY:d(7,0),positionZ:d(8,0),upX:d(3,0),upY:d(4,1),upZ:d(5,0)}})():s;return{get forwardX(){return u},get forwardY(){return c},get forwardZ(){return l},get positionX(){return d},get positionY(){return h},get positionZ(){return p},get upX(){return f},get upY(){return v},get upZ(){return m}}})(Ht,on,cn,ze,Pt),Cn=new WeakMap,An=((e,t,n,r,o,i)=>class extends n{constructor(n,i){super(n),this._nativeContext=n,c.set(this,n),r(n)&&o.set(n,new Set),this._destination=new e(this,i),this._listener=t(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(e){const t="function"==typeof e?i(this,e):null;this._nativeContext.onstatechange=t;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===t?e:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Jt,_n,Mt,Pt,Cn,ct),On=((e,t,n,r,o,i)=>(a,s)=>{const u=a.createOscillator();return ke(u,s),Ne(u,s,"detune"),Ne(u,s,"frequency"),void 0!==s.periodicWave?u.setPeriodicWave(s.periodicWave):Te(u,s,"type"),t(n,(()=>n(a)))||De(u),t(r,(()=>r(a)))||i(u,a),t(o,(()=>o(a)))||Le(u),e(a,u),u})(Vt,vt,rt,ot,it,ut),Sn=((e,t,n,r,o)=>()=>{const i=new WeakMap;let a=null,s=null,u=null;return{set periodicWave(e){a=e},set start(e){s=e},set stop(e){u=e},render(c,l,d){const h=i.get(l);return void 0!==h?Promise.resolve(h):(async(c,l,d)=>{let h=n(c);const p=M(h,l);if(!p){const e={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,detune:h.detune.value,frequency:h.frequency.value,periodicWave:null===a?void 0:a,type:h.type};h=t(l,e),null!==s&&h.start(s),null!==u&&h.stop(u)}return i.set(l,h),p?(await e(l,c.detune,h.detune,d),await e(l,c.frequency,h.frequency,d)):(await r(l,c.detune,h.detune,d),await r(l,c.frequency,h.frequency,d)),await o(c,l,h,d),h})(c,l,d)}}})(zt,On,K,Xt,_t),Pn=((e,t,n,r,o,i,a)=>class extends e{constructor(e,a){const s=o(e),u={...Ze,...a},c=n(s,u),l=i(s),d=l?r():null,h=e.sampleRate/2;super(e,!1,c,d),this._detune=t(this,l,c.detune,153600,-153600),this._frequency=t(this,l,c.frequency,h,-h),this._nativeOscillatorNode=c,this._onended=null,this._oscillatorNodeRenderer=d,null!==this._oscillatorNodeRenderer&&void 0!==u.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=u.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(e){const t="function"==typeof e?a(this,e):null;this._nativeOscillatorNode.onended=t;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===t?e:n}get type(){return this._nativeOscillatorNode.type}set type(e){this._nativeOscillatorNode.type=e,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}start(e=0){if(this._nativeOscillatorNode.start(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=e),"closed"!==this.context.state){A(this);const e=()=>{this._nativeOscillatorNode.removeEventListener("ended",e),D(this)&&S(this)};this._nativeOscillatorNode.addEventListener("ended",e)}}stop(e=0){this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}})(Rt,Ht,On,Sn,At,Pt,ct),xn=(e=>(t,n)=>{const r=e(t,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),o=t.createBuffer(1,2,44100);return r.buffer=o,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}})(Yt),Mn=((e,t,n,r,o)=>(i,{curve:a,oversample:s,...u})=>{const c=i.createWaveShaper(),l=i.createWaveShaper();ke(c,u),ke(l,u);const d=n(i,{...u,gain:1}),h=n(i,{...u,gain:-1}),p=n(i,{...u,gain:1}),f=n(i,{...u,gain:-1});let v=null,m=!1,y=null;const g={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(e){d.channelCount=e,h.channelCount=e,c.channelCount=e,p.channelCount=e,l.channelCount=e,f.channelCount=e},get channelCountMode(){return c.channelCountMode},set channelCountMode(e){d.channelCountMode=e,h.channelCountMode=e,c.channelCountMode=e,p.channelCountMode=e,l.channelCountMode=e,f.channelCountMode=e},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(e){d.channelInterpretation=e,h.channelInterpretation=e,c.channelInterpretation=e,p.channelInterpretation=e,l.channelInterpretation=e,f.channelInterpretation=e},get context(){return c.context},get curve(){return y},set curve(n){if(null!==n&&n.length<2)throw t();if(null===n)c.curve=n,l.curve=n;else{const e=n.length,t=new Float32Array(e+2-e%2),r=new Float32Array(e+2-e%2);t[0]=n[0],r[0]=-n[e-1];const o=Math.ceil((e+1)/2),i=(e+1)/2-1;for(let a=1;a<o;a+=1){const s=a/o*i,u=Math.floor(s),c=Math.ceil(s);t[a]=u===c?n[u]:(1-(s-u))*n[u]+(1-(c-s))*n[c],r[a]=u===c?-n[e-1-u]:-(1-(s-u))*n[e-1-u]-(1-(c-s))*n[e-1-c]}t[o]=e%2==1?n[o-1]:(n[o-2]+n[o-1])/2,c.curve=t,l.curve=r}y=n,m&&(r(y)&&null===v?v=e(i,d):null!==v&&(v(),v=null))},get inputs(){return[d]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(e){c.oversample=e,l.oversample=e},addEventListener:(...e)=>d.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>d.dispatchEvent(e[0]),removeEventListener:(...e)=>d.removeEventListener(e[0],e[1],e[2])};return null!==a&&(g.curve=a instanceof Float32Array?a:new Float32Array(a)),s!==g.oversample&&(g.oversample=s),o(We(g,p),(()=>{d.connect(c).connect(p),d.connect(h).connect(l).connect(f).connect(p),m=!0,r(y)&&(v=e(i,d))}),(()=>{d.disconnect(c),c.disconnect(p),d.disconnect(h),h.disconnect(l),l.disconnect(f),f.disconnect(p),m=!1,null!==v&&(v(),v=null)}))})(xn,Oe,Ue,et,nn),En=((e,t,n,r,o,i,a)=>(s,u)=>{const c=s.createWaveShaper();if(null!==i&&"webkitAudioContext"===i.name&&void 0===s.createGain().gain.automationRate)return n(s,u);ke(c,u);const l=null===u.curve||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(null!==l&&l.length<2)throw t();Te(c,{curve:l},"curve"),Te(c,u,"oversample");let d=null,h=!1;return a(c,"curve",(e=>()=>e.call(c)),(t=>n=>(t.call(c,n),h&&(r(n)&&null===d?d=e(s,c):r(n)||null===d||(d(),d=null)),n))),o(c,(()=>{h=!0,r(c.curve)&&(d=e(s,c))}),(()=>{h=!1,null!==d&&(d(),d=null)}))})(xn,Oe,Mn,et,nn,Et,tt),In=(Cr=((e,t,n,r,o,i,a,s,u)=>(c,{coneInnerAngle:l,coneOuterAngle:d,coneOuterGain:h,distanceModel:p,maxDistance:f,orientationX:v,orientationY:m,orientationZ:y,panningModel:g,positionX:w,positionY:b,positionZ:_,refDistance:C,rolloffFactor:A,...O})=>{const S=c.createPanner();if(O.channelCount>2)throw a();if("max"===O.channelCountMode)throw a();ke(S,O);const P={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},x=n(c,{...P,channelInterpretation:"speakers",numberOfInputs:6}),M=r(c,{...O,gain:1}),E=r(c,{...P,gain:1}),I=r(c,{...P,gain:0}),T=r(c,{...P,gain:0}),k=r(c,{...P,gain:0}),R=r(c,{...P,gain:0}),N=r(c,{...P,gain:0}),D=o(c,256,6,1),L=i(c,{...P,curve:new Float32Array([1,1]),oversample:"none"});let j=[v,m,y],F=[w,b,_];D.onaudioprocess=({inputBuffer:e})=>{const t=[e.getChannelData(0)[0],e.getChannelData(1)[0],e.getChannelData(2)[0]];t.some(((e,t)=>e!==j[t]))&&(S.setOrientation(...t),j=t);const n=[e.getChannelData(3)[0],e.getChannelData(4)[0],e.getChannelData(5)[0]];n.some(((e,t)=>e!==F[t]))&&(S.setPosition(...n),F=n)},Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(T.gain,"defaultValue",{get:()=>0}),Object.defineProperty(k.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"defaultValue",{get:()=>0});const B={get bufferSize(){},get channelCount(){return S.channelCount},set channelCount(e){if(e>2)throw a();M.channelCount=e,S.channelCount=e},get channelCountMode(){return S.channelCountMode},set channelCountMode(e){if("max"===e)throw a();M.channelCountMode=e,S.channelCountMode=e},get channelInterpretation(){return S.channelInterpretation},set channelInterpretation(e){M.channelInterpretation=e,S.channelInterpretation=e},get coneInnerAngle(){return S.coneInnerAngle},set coneInnerAngle(e){S.coneInnerAngle=e},get coneOuterAngle(){return S.coneOuterAngle},set coneOuterAngle(e){S.coneOuterAngle=e},get coneOuterGain(){return S.coneOuterGain},set coneOuterGain(e){if(e<0||e>1)throw t();S.coneOuterGain=e},get context(){return S.context},get distanceModel(){return S.distanceModel},set distanceModel(e){S.distanceModel=e},get inputs(){return[M]},get maxDistance(){return S.maxDistance},set maxDistance(e){if(e<0)throw new RangeError;S.maxDistance=e},get numberOfInputs(){return S.numberOfInputs},get numberOfOutputs(){return S.numberOfOutputs},get orientationX(){return E.gain},get orientationY(){return I.gain},get orientationZ(){return T.gain},get panningModel(){return S.panningModel},set panningModel(e){S.panningModel=e},get positionX(){return k.gain},get positionY(){return R.gain},get positionZ(){return N.gain},get refDistance(){return S.refDistance},set refDistance(e){if(e<0)throw new RangeError;S.refDistance=e},get rolloffFactor(){return S.rolloffFactor},set rolloffFactor(e){if(e<0)throw new RangeError;S.rolloffFactor=e},addEventListener:(...e)=>M.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>M.dispatchEvent(e[0]),removeEventListener:(...e)=>M.removeEventListener(e[0],e[1],e[2])};return l!==B.coneInnerAngle&&(B.coneInnerAngle=l),d!==B.coneOuterAngle&&(B.coneOuterAngle=d),h!==B.coneOuterGain&&(B.coneOuterGain=h),p!==B.distanceModel&&(B.distanceModel=p),f!==B.maxDistance&&(B.maxDistance=f),v!==B.orientationX.value&&(B.orientationX.value=v),m!==B.orientationY.value&&(B.orientationY.value=m),y!==B.orientationZ.value&&(B.orientationZ.value=y),g!==B.panningModel&&(B.panningModel=g),w!==B.positionX.value&&(B.positionX.value=w),b!==B.positionY.value&&(B.positionY.value=b),_!==B.positionZ.value&&(B.positionZ.value=_),C!==B.refDistance&&(B.refDistance=C),A!==B.rolloffFactor&&(B.rolloffFactor=A),1===j[0]&&0===j[1]&&0===j[2]||S.setOrientation(...j),0===F[0]&&0===F[1]&&0===F[2]||S.setPosition(...F),u(We(B,S),(()=>{M.connect(S),e(M,L,0,0),L.connect(E).connect(x,0,0),L.connect(I).connect(x,0,1),L.connect(T).connect(x,0,2),L.connect(k).connect(x,0,3),L.connect(R).connect(x,0,4),L.connect(N).connect(x,0,5),x.connect(D).connect(c.destination)}),(()=>{M.disconnect(S),s(M,L,0,0),L.disconnect(E),E.disconnect(x),L.disconnect(I),I.disconnect(x),L.disconnect(T),T.disconnect(x),L.disconnect(k),k.disconnect(x),L.disconnect(R),R.disconnect(x),L.disconnect(N),N.disconnect(x),x.disconnect(D),D.disconnect(c.destination)}))})(Z,Oe,on,Ue,ze,En,Ye,J,nn),(e,t)=>{const n=e.createPanner();return void 0===n.orientationX?Cr(e,t):(ke(n,t),Ne(n,t,"orientationX"),Ne(n,t,"orientationY"),Ne(n,t,"orientationZ"),Ne(n,t,"positionX"),Ne(n,t,"positionY"),Ne(n,t,"positionZ"),Te(n,t,"coneInnerAngle"),Te(n,t,"coneOuterAngle"),Te(n,t,"coneOuterGain"),Te(n,t,"distanceModel"),Te(n,t,"maxDistance"),Te(n,t,"panningModel"),Te(n,t,"refDistance"),Te(n,t,"rolloffFactor"),n)}),Tn=((e,t,n,r,o,i,a,s,u,c)=>()=>{const l=new WeakMap;let d=null;return{render(h,p,f){const v=l.get(p);return void 0!==v?Promise.resolve(v):(async(h,p,f)=>{let v=null,m=i(h);const y={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},g={...y,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},w=M(m,p);if("bufferSize"in m)v=r(p,{...y,gain:1});else if(!w){const e={...g,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=o(p,e)}if(l.set(p,null===v?m:v),null!==v){if(null===d){if(null===a)throw new Error("Missing the native OfflineAudioContext constructor.");const e=new a(6,h.context.length,p.sampleRate),r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});r.connect(e.destination),d=(async()=>{const t=await Promise.all([h.orientationX,h.orientationY,h.orientationZ,h.positionX,h.positionY,h.positionZ].map((async(t,r)=>{const o=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===r?1:0});return await s(e,t,o.offset,f),o})));for(let e=0;e<6;e+=1)t[e].connect(r,0,e),t[e].start(0);return c(e)})()}const e=await d,i=r(p,{...y,gain:1});await u(h,p,i,f);const l=[];for(let t=0;t<e.numberOfChannels;t+=1)l.push(e.getChannelData(t));let m=[l[0][0],l[1][0],l[2][0]],w=[l[3][0],l[4][0],l[5][0]],b=r(p,{...y,gain:1}),_=o(p,{...g,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:w[0],positionY:w[1],positionZ:w[2]});i.connect(b).connect(_.inputs[0]),_.connect(v);for(let t=128;t<e.length;t+=128){const e=[l[0][t],l[1][t],l[2][t]],n=[l[3][t],l[4][t],l[5][t]];if(e.some(((e,t)=>e!==m[t]))||n.some(((e,t)=>e!==w[t]))){m=e,w=n;const a=t/p.sampleRate;b.gain.setValueAtTime(0,a),b=r(p,{...y,gain:0}),_=o(p,{...g,orientationX:m[0],orientationY:m[1],orientationZ:m[2],positionX:w[0],positionY:w[1],positionZ:w[2]}),b.gain.setValueAtTime(1,a),i.connect(b).connect(_.inputs[0]),_.connect(v)}}return v}return w?(await e(p,h.orientationX,m.orientationX,f),await e(p,h.orientationY,m.orientationY,f),await e(p,h.orientationZ,m.orientationZ,f),await e(p,h.positionX,m.positionX,f),await e(p,h.positionY,m.positionY,f),await e(p,h.positionZ,m.positionZ,f)):(await s(p,h.orientationX,m.orientationX,f),await s(p,h.orientationY,m.orientationY,f),await s(p,h.orientationZ,m.orientationZ,f),await s(p,h.positionX,m.positionX,f),await s(p,h.positionY,m.positionY,f),await s(p,h.positionZ,m.positionZ,f)),X(m)?await u(h,p,m.inputs[0],f):await u(h,p,m,f),m})(h,p,f)}}})(zt,on,cn,Ue,In,K,St,Xt,_t,gn),kn=((e,t,n,r,o,i,a)=>class extends e{constructor(e,s){const u=o(e),c={...He,...s},l=n(u,c),d=i(u);super(e,!1,l,d?r():null),this._nativePannerNode=l,this._orientationX=t(this,d,l.orientationX,N,R),this._orientationY=t(this,d,l.orientationY,N,R),this._orientationZ=t(this,d,l.orientationZ,N,R),this._positionX=t(this,d,l.positionX,N,R),this._positionY=t(this,d,l.positionY,N,R),this._positionZ=t(this,d,l.positionZ,N,R),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(e){this._nativePannerNode.coneInnerAngle=e}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(e){this._nativePannerNode.coneOuterAngle=e}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(e){this._nativePannerNode.coneOuterGain=e}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(e){this._nativePannerNode.distanceModel=e}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(e){this._nativePannerNode.maxDistance=e}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(e){this._nativePannerNode.panningModel=e}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(e){this._nativePannerNode.refDistance=e}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(e){this._nativePannerNode.rolloffFactor=e}})(Rt,Ht,In,Tn,At,Pt,en),Rn=((e,t,n,r)=>class r{constructor(r,o){const i=t(r),a=(e=>{const{imag:t,real:n}=e;return void 0===t?void 0===n?{...e,imag:[0,0],real:[0,0]}:{...e,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...e,imag:t,real:Array.from(t,(()=>0))}:{...e,imag:t,real:n}})({...Qe,...o}),s=e(i,a);return n.add(s),s}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===r.prototype||n.has(e)}})((e=>(t,{disableNormalization:n,imag:r,real:o})=>{const i=r instanceof Float32Array?r:new Float32Array(r),a=o instanceof Float32Array?o:new Float32Array(o),s=t.createPeriodicWave(a,i,{disableNormalization:n});if(Array.from(r).length<2)throw e();return s})(I),At,new WeakSet),Nn=((e,t)=>(n,r)=>{const o=r.channelCountMode;if("clamped-max"===o)throw t();if(void 0===n.createStereoPanner)return e(n,r);const i=n.createStereoPanner();return ke(i,r),Ne(i,r,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>o,set:e=>{if(e!==o)throw t()}}),i})(((e,t,n,r,o,i)=>{const a=16385,s=new Float32Array([1,1]),u=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...c,oversample:"none"},d=(e,i,d,h,p)=>{if(1===i)return((e,t,o,i)=>{const d=new Float32Array(a),h=new Float32Array(a);for(let e=0;e<a;e+=1){const t=e/16384*u;d[e]=Math.cos(t),h[e]=Math.sin(t)}const p=n(e,{...c,gain:0}),f=r(e,{...l,curve:d}),v=r(e,{...l,curve:s}),m=n(e,{...c,gain:0}),y=r(e,{...l,curve:h});return{connectGraph(){t.connect(p),t.connect(void 0===v.inputs?v:v.inputs[0]),t.connect(m),v.connect(o),o.connect(void 0===f.inputs?f:f.inputs[0]),o.connect(void 0===y.inputs?y:y.inputs[0]),f.connect(p.gain),y.connect(m.gain),p.connect(i,0,0),m.connect(i,0,1)},disconnectGraph(){t.disconnect(p),t.disconnect(void 0===v.inputs?v:v.inputs[0]),t.disconnect(m),v.disconnect(o),o.disconnect(void 0===f.inputs?f:f.inputs[0]),o.disconnect(void 0===y.inputs?y:y.inputs[0]),f.disconnect(p.gain),y.disconnect(m.gain),p.disconnect(i,0,0),m.disconnect(i,0,1)}}})(e,d,h,p);if(2===i)return((e,o,i,d)=>{const h=new Float32Array(a),p=new Float32Array(a),f=new Float32Array(a),v=new Float32Array(a),m=Math.floor(8192.5);for(let e=0;e<a;e+=1)if(e>m){const t=(e-m)/(16384-m)*u;h[e]=Math.cos(t),p[e]=Math.sin(t),f[e]=0,v[e]=1}else{const t=e/(16384-m)*u;h[e]=1,p[e]=0,f[e]=Math.cos(t),v[e]=Math.sin(t)}const y=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),g=n(e,{...c,gain:0}),w=r(e,{...l,curve:h}),b=n(e,{...c,gain:0}),_=r(e,{...l,curve:p}),C=r(e,{...l,curve:s}),A=n(e,{...c,gain:0}),O=r(e,{...l,curve:f}),S=n(e,{...c,gain:0}),P=r(e,{...l,curve:v});return{connectGraph(){o.connect(y),o.connect(void 0===C.inputs?C:C.inputs[0]),y.connect(g,0),y.connect(b,0),y.connect(A,1),y.connect(S,1),C.connect(i),i.connect(void 0===w.inputs?w:w.inputs[0]),i.connect(void 0===_.inputs?_:_.inputs[0]),i.connect(void 0===O.inputs?O:O.inputs[0]),i.connect(void 0===P.inputs?P:P.inputs[0]),w.connect(g.gain),_.connect(b.gain),O.connect(A.gain),P.connect(S.gain),g.connect(d,0,0),A.connect(d,0,0),b.connect(d,0,1),S.connect(d,0,1)},disconnectGraph(){o.disconnect(y),o.disconnect(void 0===C.inputs?C:C.inputs[0]),y.disconnect(g,0),y.disconnect(b,0),y.disconnect(A,1),y.disconnect(S,1),C.disconnect(i),i.disconnect(void 0===w.inputs?w:w.inputs[0]),i.disconnect(void 0===_.inputs?_:_.inputs[0]),i.disconnect(void 0===O.inputs?O:O.inputs[0]),i.disconnect(void 0===P.inputs?P:P.inputs[0]),w.disconnect(g.gain),_.disconnect(b.gain),O.disconnect(A.gain),P.disconnect(S.gain),g.disconnect(d,0,0),A.disconnect(d,0,0),b.disconnect(d,0,1),S.disconnect(d,0,1)}}})(e,d,h,p);throw o()};return(t,{channelCount:r,channelCountMode:a,pan:s,...u})=>{if("max"===a)throw o();const c=e(t,{...u,channelCount:1,channelCountMode:a,numberOfInputs:2}),l=n(t,{...u,channelCount:r,channelCountMode:a,gain:1}),h=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:s});let{connectGraph:p,disconnectGraph:f}=d(t,r,l,h,c);Object.defineProperty(h.gain,"defaultValue",{get:()=>0}),Object.defineProperty(h.gain,"maxValue",{get:()=>1}),Object.defineProperty(h.gain,"minValue",{get:()=>-1});const v={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(e){l.channelCount!==e&&(m&&f(),({connectGraph:p,disconnectGraph:f}=d(t,e,l,h,c)),m&&p()),l.channelCount=e},get channelCountMode(){return l.channelCountMode},set channelCountMode(e){if("clamped-max"===e||"max"===e)throw o();l.channelCountMode=e},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(e){l.channelInterpretation=e},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return h.gain},addEventListener:(...e)=>l.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>l.dispatchEvent(e[0]),removeEventListener:(...e)=>l.removeEventListener(e[0],e[1],e[2])};let m=!1;return i(We(v,c),(()=>{p(),m=!0}),(()=>{f(),m=!1}))}})(on,Be,Ue,En,Ye,nn),Ye),Dn=((e,t,n,r,o)=>()=>{const i=new WeakMap;return{render(a,s,u){const c=i.get(s);return void 0!==c?Promise.resolve(c):(async(a,s,u)=>{let c=n(a);const l=M(c,s);if(!l){const e={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=t(s,e)}return i.set(s,c),l?await e(s,a.pan,c.pan,u):await r(s,a.pan,c.pan,u),X(c)?await o(a,s,c.inputs[0],u):await o(a,s,c,u),c})(a,s,u)}}})(zt,Nn,K,Xt,_t),Ln=((e,t,n,r,o,i)=>class extends e{constructor(e,a){const s=o(e),u={...$e,...a},c=n(s,u),l=i(s);super(e,!1,c,l?r():null),this._pan=t(this,l,c.pan)}get pan(){return this._pan}})(Rt,Ht,Nn,Dn,At,Pt),jn=((e,t,n)=>()=>{const r=new WeakMap;return{render(o,i,a){const s=r.get(i);return void 0!==s?Promise.resolve(s):(async(o,i,a)=>{let s=t(o);if(!M(s,i)){const t={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,curve:s.curve,oversample:s.oversample};s=e(i,t)}return r.set(i,s),X(s)?await n(o,i,s.inputs[0],a):await n(o,i,s,a),s})(o,i,a)}}})(En,K,_t),Fn=((e,t,n,r,o,i,a)=>class extends e{constructor(e,t){const s=o(e),u={...Ke,...t},c=n(s,u);super(e,!0,c,i(s)?r():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=c,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(e){this._nativeWaveShaperNode.oversample=e}})(Rt,Oe,En,jn,At,Pt,en),Bn=(e=>null!==e&&e.isSecureContext)(gt),Wn=(e=>(t,n,r)=>{Object.defineProperties(e,{currentFrame:{configurable:!0,get:()=>Math.round(t*n)},currentTime:{configurable:!0,get:()=>t}});try{return r()}finally{null!==e&&(delete e.currentFrame,delete e.currentTime)}})(gt),Gn=new WeakMap,Un=((e,t)=>n=>{let r=e.get(n);if(void 0!==r)return r;if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new t(1,1,8e3),e.set(n,r),r})(Gn,St),Vn=(e=>null===e?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null)(gt),qn=Bn?((e,t,n,r,o,i,a,s,u,c,l,d)=>(p,f,v={credentials:"omit"})=>{const w=i(p);if(void 0!==w.audioWorklet)return Promise.all([o(f),Promise.resolve(e(l,l))]).then((([[e,t],n])=>{const[r,o]=m(e,t),i=n?o:o.replace(/\s+extends\s+AudioWorkletProcessor\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),u=new Blob([`${r};(registerProcessor=>{${i}\n})((n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`],{type:"application/javascript; charset=utf-8"}),c=URL.createObjectURL(u);return w.audioWorklet.addModule(c,v).then((()=>{if(!s(w))return a(w).audioWorklet.addModule(c,v)})).finally((()=>URL.revokeObjectURL(c)))}));const b=c.get(p);if(void 0!==b&&b.has(f))return Promise.resolve();const _=u.get(p);if(void 0!==_){const e=_.get(f);if(void 0!==e)return e}const C=o(f).then((([e,t])=>{const[r,o]=m(e,t);return n(`${r};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${o}\n})})(window,'_AWGS')`)})).then((()=>{const e=d._AWGS.pop();if(void 0===e)throw new SyntaxError;r(w.currentTime,w.sampleRate,(()=>e(class{},void 0,((e,n)=>{if(""===e.trim())throw t();const r=h.get(w);if(void 0!==r){if(r.has(e))throw t();g(n),y(n.parameterDescriptors),r.set(e,n)}else g(n),y(n.parameterDescriptors),h.set(w,new Map([[e,n]]))}),w.sampleRate,void 0,void 0)))}));return void 0===_?u.set(p,new Map([[f,C]])):_.set(f,C),C.then((()=>{const e=c.get(p);void 0===e?c.set(p,new Set([f])):e.add(f)})).finally((()=>{const e=u.get(p);void 0!==e&&e.delete(f)})),C})(vt,Ye,(e=>t=>new Promise(((n,r)=>{if(null===e)return void r(new SyntaxError);const o=e.document.head;if(null===o)r(new SyntaxError);else{const i=e.document.createElement("script"),a=new Blob([t],{type:"application/javascript"}),s=URL.createObjectURL(a),u=e.onerror,c=()=>{e.onerror=u,URL.revokeObjectURL(s)};e.onerror=(t,n,o,i,a)=>n===s||n===e.location.href&&1===o&&1===i?(c(),r(a),!1):null!==u?u(t,n,o,i,a):void 0,i.onerror=()=>{c(),r(new SyntaxError)},i.onload=()=>{c(),n()},i.src=s,i.type="module",o.appendChild(i)}})))(gt),Wn,(async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw new DOMException("","AbortError")}),At,Un,Pt,new WeakMap,new WeakMap,((e,t)=>async()=>{if(null===e)return!0;if(null===t)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new t(1,128,8e3),o=URL.createObjectURL(n);let i=!1,a=!1;try{await r.audioWorklet.addModule(o);const t=new e(r,"a",{numberOfOutputs:0}),n=r.createOscillator();t.port.onmessage=()=>i=!0,t.onprocessorerror=()=>a=!0,n.connect(t),await r.startRendering()}catch{}finally{URL.revokeObjectURL(o)}return i&&!a})(Vn,St),gt):void 0,zn=((e,t)=>n=>e(n)||t(n))(It,Pt),Yn=((e,t,n,r,o,i,a,s,u,c,l)=>(n,r)=>{const d=a(n)?n:i(n);if(o.has(r)){const e=new DOMException("","DataCloneError");return Promise.reject(e)}try{o.add(r)}catch{}return t(u,(()=>u(d)))?d.decodeAudioData(r).then((n=>(t(s,(()=>s(n)))||l(n),e.add(n),n))):new Promise(((t,n)=>{const o=()=>{try{(e=>{const{port1:t}=new MessageChannel;t.postMessage(e,[e])})(r)}catch{}},i=e=>{n(e),o()};try{d.decodeAudioData(r,(n=>{"function"!=typeof n.copyFromChannel&&(c(n),T(n)),e.add(n),o(),t(n)}),(e=>{i(null===e?new DOMException("","EncodingError"):e)}))}catch(e){i(e)}}))})(Lt,vt,0,0,new WeakSet,At,zn,E,Ee,Wt,Gt),Xn=((e,t,n,r,o,i,a,s,u,c,l,d,h,p,f,v,m,y,g,w)=>class extends f{constructor(t,n){super(t,n),this._nativeContext=t,this._audioWorklet=void 0===e?void 0:{addModule:(t,n)=>e(this,t,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new t(this)}createBiquadFilter(){return new o(this)}createBuffer(e,t,r){return new n({length:t,numberOfChannels:e,sampleRate:r})}createBufferSource(){return new r(this)}createChannelMerger(e=6){return new i(this,{numberOfInputs:e})}createChannelSplitter(e=6){return new a(this,{numberOfOutputs:e})}createConstantSource(){return new s(this)}createConvolver(){return new u(this)}createDelay(e=1){return new l(this,{maxDelayTime:e})}createDynamicsCompressor(){return new d(this)}createGain(){return new h(this)}createIIRFilter(e,t){return new p(this,{feedback:t,feedforward:e})}createOscillator(){return new v(this)}createPanner(){return new m(this)}createPeriodicWave(e,t,n={disableNormalization:!1}){return new y(this,{...n,imag:t,real:e})}createStereoPanner(){return new g(this)}createWaveShaper(){return new w(this)}decodeAudioData(e,t,n){return c(this._nativeContext,e).then((e=>("function"==typeof t&&t(e),e))).catch((e=>{throw"function"==typeof n&&n(e),e}))}})(qn,Dt,Ut,$t,tn,an,sn,ln,hn,Yn,pn,vn,mn,bn,An,Pn,kn,Rn,Ln,Fn),Zn=((e,t,n,r)=>class extends e{constructor(e,t){const o=n(e),i=((e,t)=>e.createMediaElementSource(t.mediaElement))(o,t);if(r(o))throw TypeError();super(e,!0,i,null),this._nativeMediaElementAudioSourceNode=i}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(Rt,0,At,Pt),Hn=((e,t,n,r)=>class extends e{constructor(e,t){const o=n(e);if(r(o))throw new TypeError;const i=((e,t)=>{const n=e.createMediaStreamDestination();return ke(n,t),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n})(o,{...Me,...t});super(e,!1,i,null),this._nativeMediaStreamAudioDestinationNode=i}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(Rt,0,At,Pt),Qn=((e,t,n,r)=>class extends e{constructor(e,t){const o=n(e),i=((e,{mediaStream:t})=>{const n=t.getAudioTracks();n.sort(((e,t)=>e.id<t.id?-1:e.id>t.id?1:0));const r=n.slice(0,1),o=e.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(o,"mediaStream",{value:t}),o})(o,t);if(r(o))throw new TypeError;super(e,!0,i,null),this._nativeMediaStreamAudioSourceNode=i}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(Rt,0,At,Pt),$n=((e,t,n)=>class extends e{constructor(e,r){const o=n(e);super(e,!0,t(o,r),null)}})(Rt,((e,t)=>(n,{mediaStreamTrack:r})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(r);const o=new MediaStream([r]),i=n.createMediaStreamSource(o);if("audio"!==r.kind)throw e();if(t(n))throw new TypeError;return i})(Oe,Pt),At),Jn=((e,t,n,r,o,i,a,s,u)=>class extends e{constructor(e={}){if(null===u)throw new Error("Missing the native AudioContext constructor.");const t=new u(e);if(null===t)throw r();if(!G(e.latencyHint))throw new TypeError(`The provided value '${e.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==e.sampleRate&&t.sampleRate!==e.sampleRate)throw n();super(t,2);const{latencyHint:o}=e,{sampleRate:i}=t;if(this._baseLatency="number"==typeof t.baseLatency?t.baseLatency:"balanced"===o?512/i:"interactive"===o||void 0===o?256/i:"playback"===o?1024/i:128*Math.max(2,Math.min(128,Math.round(o*i/128)))/i,this._nativeAudioContext=t,"webkitAudioContext"===u.name?(this._nativeGainNode=t.createGain(),this._nativeOscillatorNode=t.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(t.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===t.state){this._state="suspended";const e=()=>{"suspended"===this._state&&(this._state=null),t.removeEventListener("statechange",e)};t.addEventListener("statechange",e)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw t()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),W(this)})))}createMediaElementSource(e){return new o(this,{mediaElement:e})}createMediaStreamDestination(){return new i(this)}createMediaStreamSource(e){return new a(this,{mediaStream:e})}createMediaStreamTrackSource(e){return new s(this,{mediaStreamTrack:e})}resume(){return"suspended"===this._state?new Promise(((e,t)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?e():this.resume().then(e,t)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((e=>{if(void 0===e||15===e.code)throw t();throw e}))}suspend(){return this._nativeAudioContext.suspend().catch((e=>{if(void 0===e)throw t();throw e}))}})(Xn,Oe,Ye,Je,Zn,Hn,Qn,$n,Et),Kn=(e=>t=>{const n=e.get(t);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(Cn),er=(e=>(t,n)=>{e(t).add(n)})(Kn),tr=(e=>(t,n,r=0,o=0)=>{const i=t[r];if(void 0===i)throw e();return ie(n)?i.connect(n,0,o):i.connect(n,0)})(I),nr=(e=>(t,n)=>{e(t).delete(n)})(Kn),rr=(e=>(t,n,r,o=0)=>void 0===n?t.forEach((e=>e.disconnect())):"number"==typeof n?_e(e,t,n).disconnect():ie(n)?void 0===r?t.forEach((e=>e.disconnect(n))):void 0===o?_e(e,t,r).disconnect(n,0):_e(e,t,r).disconnect(n,0,o):void 0===r?t.forEach((e=>e.disconnect(n))):_e(e,t,r).disconnect(n,0))(I),or=new WeakMap,ir=((e,t)=>n=>t(e,n))(or,w),ar=((e,t,n,r,o,i,a,s,u,c,l,d,h)=>(f,v,m,y)=>{if(0===y.numberOfInputs&&0===y.numberOfOutputs)throw u();const g=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(g.some((e=>e<1)))throw u();if(g.length!==y.numberOfOutputs)throw t();if("explicit"!==y.channelCountMode)throw u();const w=y.channelCount*y.numberOfInputs,b=g.reduce(((e,t)=>e+t),0),_=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(w+_>6||b>6)throw u();const C=new MessageChannel,A=[],O=[];for(let e=0;e<y.numberOfInputs;e+=1)A.push(a(f,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),O.push(o(f,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const S=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:e,maxValue:t,minValue:n,name:r}of m.parameterDescriptors){const o=i(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==y.parameterData[r]?y.parameterData[r]:void 0===e?0:e});Object.defineProperties(o.offset,{defaultValue:{get:()=>void 0===e?0:e},maxValue:{get:()=>void 0===t?N:t},minValue:{get:()=>void 0===n?R:n}}),S.push(o)}const P=r(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,w+_)}),x=je(v,f.sampleRate),M=s(f,x,w+_,Math.max(1,b)),E=o(f,{channelCount:Math.max(1,b),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,b)}),I=[];for(let e=0;e<y.numberOfOutputs;e+=1)I.push(r(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[e]}));for(let e=0;e<y.numberOfInputs;e+=1){A[e].connect(O[e]);for(let t=0;t<y.channelCount;t+=1)O[e].connect(P,t,e*y.channelCount+t)}const T=new ce(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((({name:e},t)=>{const n=S[t];return n.connect(P,0,w+t),n.start(0),[e,n.offset]})));P.connect(M);let k=y.channelInterpretation,D=null;const L=0===y.numberOfOutputs?[M]:I,j={get bufferSize(){return x},get channelCount(){return y.channelCount},set channelCount(e){throw n()},get channelCountMode(){return y.channelCountMode},set channelCountMode(e){throw n()},get channelInterpretation(){return k},set channelInterpretation(e){for(const t of A)t.channelInterpretation=e;k=e},get context(){return M.context},get inputs(){return A},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},get onprocessorerror(){return D},set onprocessorerror(e){"function"==typeof D&&j.removeEventListener("processorerror",D),D="function"==typeof e?e:null,"function"==typeof D&&j.addEventListener("processorerror",D)},get parameters(){return T},get port(){return C.port2},addEventListener:(...e)=>M.addEventListener(e[0],e[1],e[2]),connect:e.bind(null,L),disconnect:c.bind(null,L),dispatchEvent:(...e)=>M.dispatchEvent(e[0]),removeEventListener:(...e)=>M.removeEventListener(e[0],e[1],e[2])},F=new Map;var B,W;C.port1.addEventListener=(B=C.port1.addEventListener,(...e)=>{if("message"===e[0]){const t="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==t){const n=F.get(e[1]);void 0!==n?e[1]=n:(e[1]=e=>{l(f.currentTime,f.sampleRate,(()=>t(e)))},F.set(t,e[1]))}}return B.call(C.port1,e[0],e[1],e[2])}),C.port1.removeEventListener=(W=C.port1.removeEventListener,(...e)=>{if("message"===e[0]){const t=F.get(e[1]);void 0!==t&&(F.delete(e[1]),e[1]=t)}return W.call(C.port1,e[0],e[1],e[2])});let G=null;Object.defineProperty(C.port1,"onmessage",{get:()=>G,set:e=>{"function"==typeof G&&C.port1.removeEventListener("message",G),G="function"==typeof e?e:null,"function"==typeof G&&(C.port1.addEventListener("message",G),C.port1.start())}}),m.prototype.port=C.port1;let U=null;((e,t,n,r)=>{let o=p.get(e);void 0===o&&(o=new WeakMap,p.set(e,o));const i=(async(e,t)=>new e(await(e=>new Promise(((t,n)=>{const{port1:r,port2:o}=new MessageChannel;r.onmessage=({data:e})=>{r.close(),o.close(),t(e)},r.onmessageerror=({data:e})=>{r.close(),o.close(),n(e)},o.postMessage(e)})))(t)))(n,r);return o.set(t,i),i})(f,j,m,y).then((e=>U=e));const V=pe(y.numberOfInputs,y.channelCount),q=pe(y.numberOfOutputs,g),z=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce(((e,{name:t})=>({...e,[t]:new Float32Array(128)})),{});let Y=!0;const X=()=>{y.numberOfOutputs>0&&M.disconnect(E);for(let e=0,t=0;e<y.numberOfOutputs;e+=1){const n=I[e];for(let r=0;r<g[e];r+=1)E.disconnect(n,t+r,r);t+=g[e]}},Z=new Map;M.onaudioprocess=({inputBuffer:e,outputBuffer:t})=>{if(null!==U){const n=d(j);for(let r=0;r<x;r+=128){for(let t=0;t<y.numberOfInputs;t+=1)for(let n=0;n<y.channelCount;n+=1)de(e,V[t],n,n,r);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((({name:t},n)=>{de(e,z,t,w+n,r)}));for(let e=0;e<y.numberOfInputs;e+=1)for(let t=0;t<g[e];t+=1)0===q[e][t].byteLength&&(q[e][t]=new Float32Array(128));try{const e=V.map(((e,t)=>{if(n[t].size>0)return Z.set(t,x/128),e;const r=Z.get(t);return void 0===r?[]:(e.every((e=>e.every((e=>0===e))))&&(1===r?Z.delete(t):Z.set(t,r-1)),e)})),o=l(f.currentTime+r/f.sampleRate,f.sampleRate,(()=>U.process(e,q,z)));Y=o;for(let e=0,n=0;e<y.numberOfOutputs;e+=1){for(let o=0;o<g[e];o+=1)he(t,q[e],o,n+o,r);n+=g[e]}}catch(e){Y=!1,j.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}))}if(!Y){for(let e=0;e<y.numberOfInputs;e+=1){A[e].disconnect(O[e]);for(let t=0;t<y.channelCount;t+=1)O[r].disconnect(P,t,e*y.channelCount+t)}if(void 0!==m.parameterDescriptors){const e=m.parameterDescriptors.length;for(let t=0;t<e;t+=1){const e=S[t];e.disconnect(P,0,w+t),e.stop()}}P.disconnect(M),M.onaudioprocess=null,H?X():J();break}}}};let H=!1;const Q=a(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),$=()=>M.connect(Q).connect(f.destination),J=()=>{M.disconnect(Q),Q.disconnect()};return $(),h(j,(()=>{if(Y){J(),y.numberOfOutputs>0&&M.connect(E);for(let e=0,t=0;e<y.numberOfOutputs;e+=1){const n=I[e];for(let r=0;r<g[e];r+=1)E.connect(n,t+r,r);t+=g[e]}}H=!0}),(()=>{Y&&($(),X()),H=!1}))})(tr,I,Oe,on,Be,cn,Ue,ze,Ye,rr,Wn,ir,nn),sr=((e,t,n,r,o)=>(i,a,s,u,c,l)=>{if(null!==s)try{const t=new s(i,u,l),r=new Map;let a=null;if(Object.defineProperties(t,{channelCount:{get:()=>l.channelCount,set:()=>{throw e()}},channelCountMode:{get:()=>"explicit",set:()=>{throw e()}},onprocessorerror:{get:()=>a,set:e=>{"function"==typeof a&&t.removeEventListener("processorerror",a),a="function"==typeof e?e:null,"function"==typeof a&&t.addEventListener("processorerror",a)}}}),t.addEventListener=(h=t.addEventListener,(...e)=>{if("processorerror"===e[0]){const t="function"==typeof e[1]?e[1]:"object"==typeof e[1]&&null!==e[1]&&"function"==typeof e[1].handleEvent?e[1].handleEvent:null;if(null!==t){const n=r.get(e[1]);void 0!==n?e[1]=n:(e[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),t(n)):t(new ErrorEvent(e[0],{...n}))},r.set(t,e[1]))}}return h.call(t,"error",e[1],e[2]),h.call(t,...e)}),t.removeEventListener=(d=t.removeEventListener,(...e)=>{if("processorerror"===e[0]){const t=r.get(e[1]);void 0!==t&&(r.delete(e[1]),e[1]=t)}return d.call(t,"error",e[1],e[2]),d.call(t,e[0],e[1],e[2])}),0!==l.numberOfOutputs){const e=n(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return t.connect(e).connect(i.destination),o(t,(()=>e.disconnect()),(()=>e.connect(i.destination)))}return t}catch(e){if(11===e.code)throw r();throw e}var d,h;if(void 0===c)throw r();return(e=>{const{port1:t}=new MessageChannel;try{t.postMessage(e)}finally{t.close()}})(l),t(i,a,c,l)})(Oe,ar,Ue,Ye,nn),ur=((e,t,n,r,o,i,a,s,u,c,l,d,h,p,f,v)=>(m,y,g)=>{const w=new WeakMap;let b=null;return{render(_,C,A){s(C,_);const O=w.get(C);return void 0!==O?Promise.resolve(O):(async(s,_,C)=>{let A=l(s),O=null;const S=M(A,_),P=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(null===d){const e=P.reduce(((e,t)=>e+t),0),n=o(_,{channelCount:Math.max(1,e),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,e)}),i=[];for(let e=0;e<s.numberOfOutputs;e+=1)i.push(r(_,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:P[e]}));const c=a(_,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1});c.connect=t.bind(null,i),c.disconnect=u.bind(null,i),O=[n,i,c]}else S||(A=new d(_,m));if(w.set(_,null===O?A:O[2]),null!==O){if(null===b){if(void 0===g)throw new Error("Missing the processor constructor.");if(null===h)throw new Error("Missing the native OfflineAudioContext constructor.");const e=s.channelCount*s.numberOfInputs,t=void 0===g.parameterDescriptors?0:g.parameterDescriptors.length,n=e+t,u=async()=>{const u=new h(n,128*Math.ceil(s.context.length/128),_.sampleRate),c=[],l=[];for(let e=0;e<y.numberOfInputs;e+=1)c.push(a(u,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),l.push(o(u,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const d=await Promise.all(Array.from(s.parameters.values()).map((async e=>{const t=i(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:e.value});return await p(u,e,t.offset,C),t}))),m=r(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,e+t)});for(let e=0;e<y.numberOfInputs;e+=1){c[e].connect(l[e]);for(let t=0;t<y.channelCount;t+=1)l[e].connect(m,t,e*y.channelCount+t)}for(const[t,n]of d.entries())n.connect(m,0,e+t),n.start(0);return m.connect(u.destination),await Promise.all(c.map((e=>f(s,u,e,C)))),v(u)};b=fe(s,0===n?null:await u(),_,y,P,g,c)}const e=await b,t=n(_,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[u,l,d]=O;null!==e&&(t.buffer=e,t.start(0)),t.connect(u);for(let e=0,t=0;e<s.numberOfOutputs;e+=1){const n=l[e];for(let r=0;r<P[e];r+=1)u.connect(n,t+r,r);t+=P[e]}return d}if(S)for(const[t,n]of s.parameters.entries())await e(_,n,A.parameters.get(t),C);else for(const[e,t]of s.parameters.entries())await p(_,t,A.parameters.get(e),C);return await f(s,_,A,C),A})(_,C,A)}}})(zt,tr,Yt,on,Be,cn,Ue,nr,rr,Wn,K,Vn,St,Xt,_t,gn),cr=(e=>t=>e.get(t))(Gn),lr=(e=>(t,n)=>{e.set(t,n)})(or),dr=Bn?((e,t,n,r,o,i,a,s,u,c,l,d,p)=>class extends t{constructor(t,l,p){var f;const v=s(t),m=u(v),y=(e=>({...e,outputChannelCount:void 0!==e.outputChannelCount?e.outputChannelCount:1===e.numberOfInputs&&1===e.numberOfOutputs?[e.channelCount]:Array.from({length:e.numberOfOutputs},(()=>1))}))({...le,...p}),g=h.get(v),w=null==g?void 0:g.get(l),b=m||"closed"!==v.state?v:null!==(f=a(v))&&void 0!==f?f:v,_=o(b,m?null:t.baseLatency,c,l,w,y);super(t,!0,_,m?r(l,y,w):null);const C=[];_.parameters.forEach(((e,t)=>{const r=n(this,m,e);C.push([t,r])})),this._nativeAudioWorkletNode=_,this._onprocessorerror=null,this._parameters=new ce(C),m&&e(v,this);const{activeInputs:A}=i(this);d(_,A)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(e){const t="function"==typeof e?p(this,e):null;this._nativeAudioWorkletNode.onprocessorerror=t;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===t?e:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(er,Rt,Ht,ur,sr,j,cr,At,Pt,Vn,0,lr,ct):void 0,hr=((e,t,n,r,o)=>class extends r{constructor(e={}){if(null===o)throw new Error("Missing the native AudioContext constructor.");const r=new o(e);if(null===r)throw n();if(!G(e.latencyHint))throw new TypeError(`The provided value '${e.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==e.sampleRate&&r.sampleRate!==e.sampleRate)throw t();super(r,2);const{latencyHint:i}=e,{sampleRate:a}=r;if(this._baseLatency="number"==typeof r.baseLatency?r.baseLatency:"balanced"===i?512/a:"interactive"===i||void 0===i?256/a:"playback"===i?1024/a:128*Math.max(2,Math.min(128,Math.round(i*a/128)))/a,this._nativeAudioContext=r,"webkitAudioContext"===o.name?(this._nativeGainNode=r.createGain(),this._nativeOscillatorNode=r.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(r.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===r.state){this._state="suspended";const e=()=>{"suspended"===this._state&&(this._state=null),r.removeEventListener("statechange",e)};r.addEventListener("statechange",e)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),W(this)})))}resume(){return"suspended"===this._state?new Promise(((e,t)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?e():this.resume().then(e,t)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(Oe,Ye,Je,An,Et),pr=((e,t)=>(n,r,o)=>{if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(n,r,o)}catch(t){if("SyntaxError"===t.name)throw e();throw t}})(Ye,St),fr=((e,t,n,r,o,i,a,s)=>{const u=[];return(c,l)=>n(c).render(c,l,u).then((()=>Promise.all(Array.from(r(l)).map((e=>n(e).render(e,l,u)))))).then((()=>o(l))).then((n=>("function"!=typeof n.copyFromChannel?(a(n),T(n)):t(i,(()=>i(n)))||s(n),e.add(n),n)))})(Lt,vt,bt,Kn,gn,E,Wt,Gt),vr=((e,t,n,r,o)=>class extends r{constructor(t){const{length:r,numberOfChannels:o,sampleRate:i}={...Ie,...t},a=n(o,r,i);e(Ee,(()=>Ee(a)))||a.addEventListener("statechange",(()=>{let e=0;const t=n=>{"running"===this._state&&(e>0?(a.removeEventListener("statechange",t),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):e+=1)};return t})()),super(a,o),this._length=r,this._nativeOfflineAudioContext=a,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(t()):(this._state="running",o(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,W(this)})))}_waitForThePromiseToSettle(e){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout((()=>this._waitForThePromiseToSettle(e)))}})(vt,Oe,pr,An,fr),mr=((e,t,n,r,o)=>class extends e{constructor(e,n,o){let i;if("number"==typeof e&&void 0!==n&&void 0!==o)i={length:n,numberOfChannels:e,sampleRate:o};else{if("object"!=typeof e)throw new Error("The given parameters are not valid.");i=e}const{length:a,numberOfChannels:s,sampleRate:u}={...Xe,...i},c=r(s,a,u);t(Ee,(()=>Ee(c)))||c.addEventListener("statechange",(()=>{let e=0;const t=n=>{"running"===this._state&&(e>0?(c.removeEventListener("statechange",t),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):e+=1)};return t})()),super(c,s),this._length=a,this._nativeOfflineAudioContext=c,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",o(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,W(this)})))}_waitForThePromiseToSettle(e){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout((()=>this._waitForThePromiseToSettle(e)))}})(Xn,vt,Oe,pr,fr),yr=((e,t)=>n=>{const r=e.get(n);return t(r)||t(n)})(c,It),gr=((e,t)=>n=>e.has(n)||t(n))(a,Tt),wr=((e,t)=>n=>e.has(n)||t(n))(u,kt),br=((e,t)=>n=>{const r=e.get(n);return t(r)||t(n)})(c,Pt),_r=()=>(async(e,t,n,r,o,i,a,s,u,c,l,d,h,p,f,v)=>!!(e(t,t)&&e(n,n)&&e(o,o)&&e(i,i)&&e(s,s)&&e(u,u)&&e(c,c)&&e(l,l)&&e(d,d)&&e(h,h)&&e(p,p))&&(await Promise.all([e(r,r),e(a,a),e(f,f),e(v,v)])).every((e=>e)))(vt,(e=>()=>{if(null===e)return!1;const t=new e(1,1,44100).createBuffer(1,1,44100);if(void 0===t.copyToChannel)return!0;const n=new Float32Array(2);try{t.copyFromChannel(n,0,0)}catch{return!1}return!0})(St),(e=>()=>{if(null===e)return!1;if(void 0!==e.prototype&&void 0!==e.prototype.close)return!0;const t=new e,n=void 0!==t.close;try{t.close()}catch{}return n})(Et),(e=>()=>{if(null===e)return Promise.resolve(!1);const t=new e(1,1,44100);return new Promise((e=>{let n=!0;const r=r=>{n&&(n=!1,t.startRendering(),e(r instanceof TypeError))};let o;try{o=t.decodeAudioData(null,(()=>{}),r)}catch(e){r(e)}void 0!==o&&o.catch(r)}))})(St),(e=>()=>{if(null===e)return!1;let t;try{t=new e({latencyHint:"balanced"})}catch{return!1}return t.close(),!0})(Et),(e=>()=>{if(null===e)return!1;const t=new e(1,1,44100).createGain(),n=t.connect(t)===t;return t.disconnect(t),n})(St),((e,t)=>async()=>{if(null===e)return!0;if(null===t)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(){this.port.postMessage(0)}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new t(1,128,8e3),o=URL.createObjectURL(n);let i=!1;try{await r.audioWorklet.addModule(o);const t=new e(r,"a",{numberOfOutputs:0}),n=r.createOscillator();t.port.onmessage=()=>i=!0,n.connect(t),n.start(0),await r.startRendering(),i||await new Promise((e=>setTimeout(e,5)))}catch{}finally{URL.revokeObjectURL(o)}return i})(Vn,St),(e=>()=>{if(null===e)return!1;const t=new e(1,1,44100).createChannelMerger();if("max"===t.channelCountMode)return!0;try{t.channelCount=2}catch{return!0}return!1})(St),(e=>()=>{if(null===e)return!1;const t=new e(1,1,44100);return void 0===t.createConstantSource||t.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY})(St),(e=>()=>{if(null===e)return!1;const t=new e(1,1,44100),n=t.createConvolver();n.buffer=t.createBuffer(1,1,t.sampleRate);try{n.buffer=t.createBuffer(1,1,t.sampleRate)}catch{return!1}return!0})(St),(e=>()=>{if(null===e)return!1;const t=new e(1,1,44100).createConvolver();try{t.channelCount=1}catch{return!1}return!0})(St),at,(e=>()=>null!==e&&e.hasOwnProperty("isSecureContext"))(gt),(e=>()=>{if(null===e)return!1;const t=new e;try{return t.createMediaStreamSource(new MediaStream),!1}catch(e){return!0}})(Et),(e=>()=>{if(null===e)return Promise.resolve(!1);const t=new e(1,1,44100);if(void 0===t.createStereoPanner)return Promise.resolve(!0);if(void 0===t.createConstantSource)return Promise.resolve(!0);const n=t.createConstantSource(),r=t.createStereoPanner();return n.channelCount=1,n.offset.value=1,r.channelCount=1,n.start(),n.connect(r).connect(t.destination),t.startRendering().then((e=>1!==e.getChannelData(0)[0]))})(St),st);var Cr},946:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.makeInitialTrackState=t.WaitingForAssetState=t.FadingOutState=t.PlayingState=t.FadingInState=t.DeadAirState=t.TimedTrackState=t.LoadingState=void 0;var i=n(259),a=function(){function e(e,t){this.track=e,this.trackOptions=t,this.asset=null}return e.prototype.play=function(){var e,t=this.track,n=this.trackOptions,r=t.loadNextAsset();if(r){var o=new i.AssetEnvelope(n,r);e=new c(t,n,{assetEnvelope:o})}else e=new h(t,n);this.track.transition(e)},e.prototype.pause=function(){},e.prototype.finish=function(){},e.prototype.skip=function(){},e.prototype.replay=function(){},e.prototype.updateParams=function(){},e.prototype.toString=function(){return"Loading"},e}();t.LoadingState=a;var s=function(){function e(e,t){this.track=e,this.windowScope=e.windowScope,this.trackOptions=t,this.timerId=null}return e.prototype.play=function(e){void 0===e&&(e=0);var t=this,n=t.timerId,r=t.timeRemainingMs,o=t.track.trackId;if(!n){if(r){var i=r/1e3;return console.log("\t[Resuming track #"+o+" timer: next state in "+i.toFixed(1)+"s]"),this.setNextStateTimer(r),i}var a=1e3*e;return this.setNextStateTimer(a),e}},e.prototype.pause=function(){this.timeRemainingMs=this.clearTimer(),console.log("\t[Pausing track #"+this.track.trackId+" timer: next state in "+(this.timeRemainingMs/1e3).toFixed(1)+"s")},e.prototype.clearTimer=function(){var e=new Date,t=this,n=t.timerId,r=t.timerApproximateEndingAtMs,o=void 0===r?e.getTime():r,i=t.windowScope;return n?(i.clearTimeout(n),delete this.timerApproximateEndingAtMs,Math.max(o-e.getTime(),0)):0},e.prototype.finish=function(){this.clearTimer(),delete this.timeRemainingMs},e.prototype.setNextStateTimer=function(e){var t=this;this.timerId=this.windowScope.setTimeout((function(){return t.setNextState()}),e),this.timerApproximateEndingAtMs=(new Date).getTime()+e},e.prototype.setNextState=function(){console.warn("Track state '"+this+"' does not implement a next state")},e.prototype.skip=function(){this.finish(),this.setNextState()},e.prototype.replay=function(){console.log("replay() not implemented yet")},e.prototype.setLoadingState=function(){var e=this.track,t=this.trackOptions,n=new a(e,t);e.transition(n)},e.prototype.updateParams=function(e){},e}();t.TimedTrackState=s;var u=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.deadAirSeconds=r.trackOptions.randomDeadAir,r}return o(t,e),t.prototype.play=function(){e.prototype.play.call(this,this.deadAirSeconds)},t.prototype.setNextState=function(){this.setLoadingState()},t.prototype.toString=function(){return"DeadAir ("+this.deadAirSeconds.toFixed(1)+"s)"},t.prototype.updateParams=function(){},t}(s);t.DeadAirState=u;var c=function(e){function t(t,n,r){var o=r.assetEnvelope,i=e.call(this,t,n)||this;return i.assetEnvelope=o,i}return o(t,e),t.prototype.play=function(){var t=this.track,n=this.assetEnvelope.fadeInDuration,r=e.prototype.play.call(this,n);r&&(t.fadeIn(r)||this.setLoadingState())},t.prototype.pause=function(){e.prototype.pause.call(this),this.track.pauseAudio()},t.prototype.setNextState=function(){var e=this,t=e.track,n=e.trackOptions,r=e.assetEnvelope;t.transition(new l(t,n,{assetEnvelope:r}))},t.prototype.toString=function(){var e=this.assetEnvelope,t=e.fadeInDuration;return"FadingIn Asset #"+e.assetId+" ("+t.toFixed(1)+"s)"},t}(s);t.FadingInState=c;var l=function(e){function t(t,n,r){var o=r.assetEnvelope,i=e.call(this,t,n)||this;return i.assetEnvelope=o,i}return o(t,e),t.prototype.play=function(){var t=this.track,n=this.assetEnvelope.startFadingOutSecs;e.prototype.play.call(this,n),t.playAudio()},t.prototype.pause=function(){e.prototype.pause.call(this),this.track.pauseAudio()},t.prototype.toString=function(){var e=this.assetEnvelope;return"Playing asset #"+e.assetId+" ("+e.startFadingOutSecs.toFixed(1)+"s)"},t.prototype.setNextState=function(){var e=this,t=e.track,n=e.trackOptions,r=e.assetEnvelope;t.transition(new d(t,n,{assetEnvelope:r}))},t}(s);t.PlayingState=l;var d=function(e){function t(t,n,r){var o=r.assetEnvelope,i=e.call(this,t,n)||this;return i.assetEnvelope=o,i}return o(t,e),t.prototype.play=function(){var t=this.track,n=this.assetEnvelope.fadeOutDuration,r=e.prototype.play.call(this,n);r&&(t.fadeOut(r)?t.playAudio():this.setLoadingState())},t.prototype.pause=function(){e.prototype.pause.call(this),this.track.pauseAudio()},t.prototype.setNextState=function(){this.track.transition(new u(this.track,this.trackOptions))},t.prototype.toString=function(){var e=this.assetEnvelope;return"FadingOut asset #"+e.assetId+" ("+e.fadeOutDuration.toFixed(1)+"s)"},t}(s);t.FadingOutState=d;var h=function(e){function t(t,n){return e.call(this,t,n)||this}return o(t,e),t.prototype.play=function(){e.prototype.play.call(this,10)},t.prototype.updateParams=function(t){void 0===t&&(t={}),e.prototype.updateParams.call(this,t),this.finish(),this.setLoadingState()},t.prototype.setNextState=function(){this.setLoadingState()},t.prototype.toString=function(){return"WaitingForAsset (10s)"},t}(s);t.WaitingForAssetState=h,t.makeInitialTrackState=function(e,t){return new(t.startWithSilence?u:a)(e,t)}},562:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ApiClient=void 0;var o="We were unable to contact the audio server, please try again.",i=function(){function e(e,t){this._jQuery=e.jQuery,this._serverUrl=t,this._authToken=""}return e.prototype.get=function(e,t,o){return void 0===o&&(o={}),n(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return o.method="GET",o.contentType="x-www-form-urlencoded",[4,this.send(e,t,o)];case 1:return[2,n.sent()]}}))}))},e.prototype.post=function(e,t,o){return void 0===o&&(o={}),n(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return o.method="POST",[4,this.send(e,t,o)];case 1:return[2,n.sent()]}}))}))},e.prototype.patch=function(e,t,o){return void 0===o&&(o={}),n(this,void 0,void 0,(function(){return r(this,(function(n){switch(n.label){case 0:return o.method="PATCH",[4,this.send(e,t,o)];case 1:return[2,n.sent()]}}))}))},e.prototype.send=function(e,t,i){return void 0===t&&(t={}),n(this,void 0,void 0,(function(){var n,a,s,u,c,l,d,h,p,f,v;return r(this,(function(r){switch(r.label){case 0:for(d in n=new URL(this._serverUrl+e),a=i.contentType,s=i.method,u={method:s,mode:"cors",body:"",headers:{}},c=new URLSearchParams(""),i)c.append(d,i[d]);switch(l={},s){case"GET":case"HEAD":for(d in t)c.append(d,t[d]);break;default:h="",a||(a="application/json",h=JSON.stringify(t)),"multipart/form-data"!=a&&(l["Content-Type"]=a),u.body=h}n.search=c.toString(),this._authToken&&(l.Authorization=this._authToken),u.headers=l,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,fetch(n.toString(),u)];case 2:return p=r.sent(),[3,4];case 3:throw f=r.sent(),console.error("Roundware network error:",f.message),o;case 4:if(!p.ok)throw console.error("Roundware API error, code:",p.status),o;r.label=5;case 5:return r.trys.push([5,7,,8]),[4,p.json()];case 6:return[2,r.sent()];case 7:throw v=r.sent(),console.error("Unable to decode Roundware response",v),o;case 8:return[2]}}))}))},Object.defineProperty(e.prototype,"authToken",{set:function(e){this._authToken="token "+e},enumerable:!1,configurable:!0}),e}();t.ApiClient=i},556:function(e,t){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Asset=t.PATH=void 0,t.PATH="/assets/";var i=function(){function e(e,t){var n=t.apiClient;this._projectId=e,this._apiClient=n}return e.prototype.toString=function(){return"Roundware Assets (#"+this._projectId+")"},e.prototype.connect=function(e){return void 0===e&&(e={}),r(this,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return r=n(n({},e),{project_id:this._projectId}),[4,this._apiClient.get(t.PATH,r)];case 1:return[2,o.sent()]}}))}))},e}();t.Asset=i},760:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.roundwareDefaultFilterChain=t.dateRangeFilter=t.timedRepeatFilter=t.assetShapeFilter=t.timedAssetFilter=t.anyTagsFilter=t.distanceRangesFilter=t.distanceFixedFilter=t.allAssetFilter=t.ASSET_PRIORITIES=void 0;var i=n(13),a=n(147),s=n(593),u=n(145);t.ASSET_PRIORITIES=Object.freeze({DISCARD:!1,NEUTRAL:0,LOWEST:1,NORMAL:100,HIGHEST:999});var c=function(){return t.ASSET_PRIORITIES.LOWEST};function l(e,n){void 0===e&&(e=[]);var i=o(n,[]);return s.isEmpty(e)?c:function(n,a){for(var s=o(a,[]),u=[],c=0,l=e;c<l.length;c++){var d=(0,l[c])(n,r(r({},i),s));if(d===t.ASSET_PRIORITIES.DISCARD)return d;u.push(d)}return u.find((function(e){return e!==t.ASSET_PRIORITIES.NEUTRAL}))||u[0]}}function d(e,t){var n=t.listenerPoint;return t.geoListenMode!==u.GeoListenMode.DISABLED&&n&&e}t.allAssetFilter=l;var h=function(e,t){return i.default(e,t,{units:"meters"})};function p(){return function(e,n){var r=n.listenTagIds;if(s.isEmpty(r))return t.ASSET_PRIORITIES.LOWEST;for(var o=e.tag_ids,i=0,a=void 0===o?[]:o;i<a.length;i++){var u=a[i];if(r.includes(u))return t.ASSET_PRIORITIES.LOWEST}return t.ASSET_PRIORITIES.DISCARD}}function f(){return function(e,n){var r=n.elapsedSeconds,o=void 0===r?0:r,i=n.timedAssetPriority,a=void 0===i?"normal":i,s=e.timedAssetStart,u=e.timedAssetEnd,c=e.playCount;if(!s||!u)return t.ASSET_PRIORITIES.DISCARD;if(s>=o||u<=o||c&&c>0)return t.ASSET_PRIORITIES.DISCARD;var l=a.toUpperCase();return t.ASSET_PRIORITIES[l]||t.ASSET_PRIORITIES.NEUTRAL}}function v(){return function(e,n){var r=e.shape;if(!r||!d(e,n))return t.ASSET_PRIORITIES.NEUTRAL;var o=n.listenerPoint;return a.default(o,r)?t.ASSET_PRIORITIES.NORMAL:t.ASSET_PRIORITIES.DISCARD}}t.distanceFixedFilter=function(){return function(e,n){if(n.geoListenMode===u.GeoListenMode.DISABLED)return t.ASSET_PRIORITIES.LOWEST;if(!d(e,n))return t.ASSET_PRIORITIES.NEUTRAL;var r=e.locationPoint,o=n.listenerPoint,i=n.recordingRadius;if(!r)throw new Error("assetLocationPoint is undefined!");return h(o,r)<i?t.ASSET_PRIORITIES.NORMAL:t.ASSET_PRIORITIES.DISCARD}},t.distanceRangesFilter=function(e,n){if(n.getListenMode===u.GeoListenMode.DISABLED)return t.ASSET_PRIORITIES.LOWEST;if(!d(e,{geoListenMode:n.getListenMode,listenerPoint:n.listenerPoint}))return t.ASSET_PRIORITIES.NEUTRAL;var r=n.listenerPoint,o=n.minDist,i=n.maxDist;if(void 0===o||void 0===i)return t.ASSET_PRIORITIES.NEUTRAL;var a=e.locationPoint;if(!a)throw new Error("locationPoint is undefined!");var s=h(r,a);return s>=o&&s<=i?t.ASSET_PRIORITIES.NORMAL:t.ASSET_PRIORITIES.DISCARD},t.anyTagsFilter=p,t.timedAssetFilter=f,t.assetShapeFilter=v,t.timedRepeatFilter=function(){return function(e,n){var r=n.bannedDuration,o=void 0===r?600:r,i=e.lastListenTime;return i?((new Date).getTime()-("number"==typeof i?i:i.getTime()))/1e3<=o?t.ASSET_PRIORITIES.DISCARD:t.ASSET_PRIORITIES.LOWEST:t.ASSET_PRIORITIES.NORMAL}},t.dateRangeFilter=function(){return function(e,n){var r=n.startDate,o=n.endDate;return r||o?(!r||e.created>=r)&&(!o||e.created<=o)?t.ASSET_PRIORITIES.NORMAL:t.ASSET_PRIORITIES.DISCARD:t.ASSET_PRIORITIES.LOWEST}},t.roundwareDefaultFilterChain=l([function(e,n){void 0===e&&(e=[]);var i=o(void 0,[]);return s.isEmpty(e)?c:function(n,a){for(var s=o(a,[]),u=0,c=e;u<c.length;u++){var l=(0,c[u])(n,r(r({},i),s));if(l!==t.ASSET_PRIORITIES.DISCARD&&l!==t.ASSET_PRIORITIES.NEUTRAL)return l}return t.ASSET_PRIORITIES.DISCARD}}([f(),v(),l([t.distanceFixedFilter(),t.distanceRangesFilter()])]),t.timedRepeatFilter(),p(),t.dateRangeFilter()])},712:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.AssetPool=void 0;var i=n(640),a=n(760),s=n(593),u=function(){function e(e){var t=e.assets,n=void 0===t?[]:t,r=e.timedAssets,o=void 0===r?[]:r,s=e.filterChain,u=void 0===s?a.roundwareDefaultFilterChain:s,c=e.sortMethods,l=void 0===c?[]:c,d=e.mixParams,h=void 0===d?{}:d;if(this.assets=n,this.updateAssets(n,o),"string"!=typeof h.ordering)throw new Error("Please pass ordering in mixParams");this.assetSorter=new i.AssetSorter({sortMethods:l,ordering:h.ordering}),this.playingTracks={},this.mixParams=h,this.filterChain=u,this.sortAssets()}return e.prototype.updateAssets=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.assets=e.map(function(e){var t=e.reduce((function(e,t){var n;return r(r({},e),((n={})[t.asset_id]=t,n))}),{});return function(e){var n=e.start_time,o=void 0===n?0:n,i=e.end_time,a=void 0===i?0:i,u=e.file,c=a-o;if(!u)throw new Error("assetUrl was undefined!");var l=s.cleanAudioURL(u),d=r(r({locationPoint:s.coordsToPoints({latitude:e.latitude||1,longitude:e.longitude||1}),playCount:0,activeRegionLength:c,activeRegionUpperBound:a,activeRegionLowerBound:o},e),{created:e.created?new Date(e.created):void 0,file:l}),h=t[e.id];return h&&(d.timedAssetStart=h.start,d.timedAssetEnd=h.end),d}}(t))},e.prototype.nextForTrack=function(e,t){var n=this,i=(t.elapsedSeconds,t.filterOutAssets),a=void 0===i?[]:i,s=o(t,["elapsedSeconds","filterOutAssets"]),u=r(r(r({},this.mixParams),e.mixParams),s);console.log("picking asset for "+e+" from "+this.assets.length+", params = "+JSON.stringify(u));var c=this.assets.reduce((function(e,t){if(a.includes(t))return e;var r=n.filterChain(t,u);return r&&(e[r]=e[r]||[],e[r].push(t)),e}),{}),l=Object.keys(c).map((function(e){return Number.parseInt(e)}));if(l!==[]){var d=c[l.sort()[0]]||[];d.sort((function(e,t){return t.playCount-e.playCount}));var h=d.pop();return h&&h.playCount++,h}console.warn("All assets filtered out")},e.prototype.sortAssets=function(){this.assetSorter.sort(this.assets)},e.prototype.add=function(e){this.assets.push(e),this.sortAssets()},e}();t.AssetPool=u},640:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AssetSorter=void 0;var r=n(703),o=n(593),i=function(){function e(e){var t=e.sortMethods,n=void 0===t?[]:t,i=e.ordering,a=void 0===i?"random":i;o.isEmpty(n)?this.sortMethods=[r.sortByProjectDefault(a)]:this.sortMethods=n.map((function(e){return r[e]}))}return e.prototype.sort=function(e){this.sortMethods.forEach((function(t){return t(e)}))},e}();t.AssetSorter=i},473:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Audiotrack=void 0;var o=function(){function e(e,t){this._projectId=e,this._apiClient=t.apiClient}return e.prototype.toString=function(){return"Roundware Audiotracks (#"+this._projectId+")"},e.prototype.connect=function(e){return void 0===e&&(e={}),n(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return e.project_id=this._projectId,e.active=!0,[4,this._apiClient.get("/audiotracks/",e)];case 1:return[2,t.sent()]}}))}))},e}();t.Audiotrack=o},255:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Envelope=void 0;var o=function(){function e(e,t,n,r){this._envelopeId="(unknown)",this._sessionId=e,this._apiClient=t,this._geoPosition=n,this._roundware=r}return e.prototype.toString=function(){return"Envelope "+this._assetId},e.prototype.connect=function(){return n(this,void 0,void 0,(function(){var e,t=this;return r(this,(function(n){return e={session_id:this._sessionId},[2,this._apiClient.post("/envelopes/",e).then((function(e){t._envelopeId=e.id}))]}))}))},e.prototype.upload=function(e,t,o){return void 0===o&&(o={}),n(this,void 0,void 0,(function(){var n,i,a,s,u;return r(this,(function(r){switch(r.label){case 0:return this._envelopeId?(n=new FormData,i={},i=o.latitude||o.longitude?{latitude:o.latitude,longitude:o.longitude}:this._geoPosition.getLastCoords(),console.log(i),n.append("session_id",this._sessionId.toString()),n.append("file",e),n.append("latitude",i.latitude.toString()),n.append("longitude",i.longitude.toString()),o.tag_ids&&n.append("tag_ids",o.tag_ids),o.media_type&&n.append("media_type",o.media_type),a="/envelopes/"+this._envelopeId+"/",console.info("Uploading "+t+" to envelope "+a),s={contentType:"multipart/form-data"},[4,this._apiClient.patch(a,n,s)]):[2,Promise.reject("cannot upload audio without first connecting this envelope to the server")];case 1:if(u=r.sent(),console.info("UPLOADDATA",u),!u.detail)return[3,2];throw new Error(u.detail);case 2:return[4,this._roundware.updateAssetPool()];case 3:return r.sent(),[2,u]}}))}))},e}();t.Envelope=o},136:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoPosition=void 0;var r=n(719),o=n(145),i={latitude:42.3140089,longitude:-71.2504676},a={enableHighAccuracy:!1,timeout:5,maximumAge:1/0},s={enableHighAccuracy:!0,timeout:1/0,maximumAge:0},u=function(){function e(e,t){this._navigator=e;var n=t.defaultCoords,r=t.geoListenMode,a=n||i;this._initialGeolocationPromise=Promise.resolve(a),this.defaultCoords=a,this._lastCoords=a,this.geolocation=e.geolocation,this.isEnabled=e.geolocation&&r===o.GeoListenMode.AUTOMATIC,this.updateCallback=function(){},this._geoWatchID=null}return e.prototype.disable=function(){this.isEnabled=!1,this._geoWatchID&&(console.log("Canceling geoposition watch",this._geoWatchID),this.geolocation.clearWatch(this._geoWatchID),delete this._geoWatchID)},e.prototype.toString=function(){return"GeoPosition (enabled: "+this.isEnabled+")"},e.prototype.getLastCoords=function(){return this._lastCoords},e.prototype.connect=function(e){this.updateCallback=e,this.isEnabled&&this.enable()},e.prototype.enable=function(){var e=this;if(!this.isEnabled||!this._geoWatchID){var t=this.defaultCoords,n=this._navigator.geolocation;this.isEnabled=!0,r.logger.log("Initializing geolocation system"),this._initialGeolocationPromise=new Promise((function(o){n.getCurrentPosition((function(t){var n=t.coords;e._lastCoords=n,r.logger.info("Received initial geolocation:",n),e.updateCallback(n),o(n)}),(function(e){r.logger.warn("Unable to get initial geolocation: "+e.message+" (code #"+e.code+"), falling back to default coordinates for initial listener location"),o(t)}),a)})),this._geoWatchID=n.watchPosition((function(t){var n=t.coords;e._lastCoords=n,r.logger.info("Received updated geolocation:",n),e.updateCallback(n)}),(function(e){return r.logger.warn("Unable to watch geoposition changes: "+e.message+" (code #"+e.code+")")}),s)}},e.prototype.waitForInitialGeolocation=function(){return this._initialGeolocationPromise},e}();t.GeoPosition=u},145:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.Mixer=t.GeoListenMode=void 0;var i=n(712),a=n(967),s=n(596),u=n(593);t.GeoListenMode=Object.freeze({DISABLED:0,MANUAL:1,AUTOMATIC:2});var c=function(){function e(e){var t=e.client,n=e.windowScope,o=e.listenerLocation,a=e.prefetchSpeakerAudio,s=e.filters,c=void 0===s?[]:s,l=e.sortMethods,d=void 0===l?[]:l,h=e.mixParams,p=void 0===h?{}:h;this.speakerTracks=[],this.playing=!1,this._windowScope=n,this._client=t,this._prefetchSpeakerAudio=a;var f=t.assets(),v=t.timedAssets();this.mixParams=r({listenerPoint:u.coordsToPoints({latitude:o.latitude,longitude:o.longitude})},p),this.assetPool=new i.AssetPool({assets:f,timedAssets:v,filters:c,sortMethods:d,mixParams:this.mixParams})}return e.prototype.updateParams=function(e){var t=e.listenerLocation,n=o(e,["listenerLocation"]);if(t&&(n.listenerPoint=u.coordsToPoints({latitude:t.latitude,longitude:t.longitude})),this.mixParams=r(r({},this.mixParams),n),this.playlist&&this.playlist.updateParams(n),this.speakerTracks)for(var i=0,a=this.speakerTracks;i<a.length;i++)a[i].updateParams(this.playing,n)},e.prototype.skipTrack=function(e){this.playlist&&this.playlist.skip(e)},e.prototype.skip=function(){},e.prototype.replayTrack=function(e){this.playlist&&this.playlist.replay(e)},e.prototype.toString=function(){return"Roundware Mixer"},e.prototype.initContext=function(){var e=this;if(!this.playlist){var t=u.buildAudioContext(this._windowScope);if(!this.mixParams.listenerPoint)throw new Error("listenerPoint was missing from mixParams!");var n=this.mixParams.listenerPoint,r=this._client.speakers(),o=u.getUrlParam(this._windowScope.location.toString(),"rwfSelectTrackId"),i=this._client.audiotracks();o&&(o=Number(o),i=i.filter((function(e){return e.id===o})),console.info("isolating track #"+o)),this.playlist=new a.Playlist({client:this._client,audioTracks:i,listenerPoint:n,assetPool:this.assetPool,audioContext:t,windowScope:this._windowScope}),this.speakerTracks=r.map((function(r){return new s.SpeakerTrack({audioContext:t,listenerPoint:n,prefetchAudio:e._prefetchSpeakerAudio,data:r})})),this.updateParams(this.mixParams)}},e.prototype.toggle=function(){return this.initContext(),this.playing?(this.playing=!1,this.playlist&&this.playlist.pause(),this.speakerTracks.forEach((function(e){return e.pause()}))):(this.playing=!0,this.playlist&&this.playlist.play(),this.speakerTracks.forEach((function(e){return e.play()}))),this.playing},e}();t.Mixer=c},259:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AssetEnvelope=void 0;var r=n(593),o=function(){function e(e,t){var n=e.randomFadeInDuration,o=e.randomFadeOutDuration,i=e.fadeOutMultiplier,a=e.durationLowerBound,s=e.durationUpperBound,u=t.activeRegionLowerBound,c=t.activeRegionUpperBound,l=t.activeRegionLength;this.asset=t,this.assetId=t.id,this.minDuration=Math.min(a,Number(l)),this.maxDuration=Math.min(s,Number(l)),this.duration=r.random(this.minDuration,this.maxDuration);var d=Number(c)-this.duration;this.start=r.random(u,d),this.fadeInDuration=Math.min(n,this.duration/2),this.fadeOutDuration=Math.min(o,this.duration/2)*Number(i),this.startFadingOutSecs=this.duration-this.fadeInDuration-this.fadeOutDuration}return e.prototype.toString=function(){return"AssetEnvelope #"+this.asset.id},e}();t.AssetEnvelope=o},373:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackOptions=void 0;var r=n(593),o=function(){function e(e,t){this.volumeRange=[t.minvolume,t.maxvolume],this.duration=[t.minduration,t.maxduration],this.deadAir=[t.mindeadair,t.maxdeadair],this.fadeInTime=[t.minfadeintime,t.maxfadeintime],this.fadeOutTime=[t.minfadeouttime,t.maxfadeouttime],this.repeatRecordings=!!t.repeatrecordings,this.tags=t.tag_filters,this.bannedDuration=t.banned_duration||600,this.startWithSilence=!r.hasOwnProperty(t,"start_with_silence")||!!t.start_with_silence,this.fadeOutWhenFiltered=!r.hasOwnProperty(t,"fadeout_when_filtered")||!!t.fadeout_when_filtered,this.fadeOutMultiplier=1;var n=e("rwfFadeOutMultiplier");n&&(this.fadeOutMultiplier=Number(n),console.log("Applying fade-out multiplier",this.fadeOutMultiplier))}return Object.defineProperty(e.prototype,"randomVolume",{get:function(){return r.random(this.volumeRangeLowerBound,this.volumeRangeUpperBound)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"randomDeadAir",{get:function(){return r.random(this.deadAirLowerBound,this.deadAirUpperBound)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"randomFadeInDuration",{get:function(){return Math.min(r.random(this.fadeInLowerBound,this.fadeInUpperBound),this.durationHalfway)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"randomFadeOutDuration",{get:function(){return Math.min(r.random(this.fadeOutLowerBound,this.fadeOutUpperBound),this.durationHalfway)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volumeRangeLowerBound",{get:function(){return this.volumeRange[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volumeRangeUpperBound",{get:function(){return this.volumeRange[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deadAirLowerBound",{get:function(){return this.deadAir[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"deadAirUpperBound",{get:function(){return this.deadAir[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"durationLowerBound",{get:function(){return this.duration[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"durationUpperBound",{get:function(){return this.duration[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"durationHalfway",{get:function(){return(this.durationUpperBound-this.durationLowerBound)/2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fadeInLowerBound",{get:function(){return this.fadeInTime[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fadeInUpperBound",{get:function(){return this.fadeInTime[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fadeOutLowerBound",{get:function(){return this.fadeOutTime[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fadeOutUpperBound",{get:function(){return this.fadeOutTime[1]},enumerable:!1,configurable:!0}),e}();t.TrackOptions=o},967:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},i=this&&this.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.Playlist=void 0;var a=n(751),s=n(593),u=function(){function e(e){var t=this,n=e.client,i=e.audioTracks,u=void 0===i?[]:i,c=e.listenerPoint,l=e.windowScope,d=e.assetPool,h=o(e,["client","audioTracks","listenerPoint","windowScope","assetPool"]);this.listenerPoint=c,this.playingTracks=[],this.assetPool=d,this.playing=!1,this.listenTagIds=[],this._client=n;var p=0,f=s.getUrlParam(l.location.toString(),"rwfTimerSeconds");if(f){var v=Number(f);p=1e3*v,console.log("Setting playlist timer to "+v.toFixed(1)+"s")}this._elapsedTimeMs=p;var m={},y=new Map;u.forEach((function(e){var n=new a.PlaylistAudiotrack(r(r({audioData:e},h),{windowScope:l,playlist:t}));m[n.trackId]=n,y.set(n,null)}),{}),this.trackMap=y,this.trackIdMap=m}return Object.defineProperty(e.prototype,"tracks",{get:function(){return i([],this.trackMap.keys())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentlyPlayingAssets",{get:function(){for(var e=[],t=0,n=this.trackMap.values();t<n.length;t++){var r=n[t];r&&e.push(r)}return e},enumerable:!1,configurable:!0}),e.prototype.updateParams=function(e){var t=e.listenerPoint,n=e.listenTagIds,r=o(e,["listenerPoint","listenTagIds"]);t&&(this.listenerPoint=t),n&&(this.listenTagIds=n.map((function(e){return Number(e)}))),this.tracks.forEach((function(e){return e.updateParams(r)}))},e.prototype.play=function(){this.tracks.forEach((function(e){return e.play()})),this.playlistLastStartedAt=new Date,this.playing=!0},e.prototype.skip=function(e){if(void 0!==e){var t=this.trackIdMap[Number(e)];t&&t.skip()}},e.prototype.replay=function(e){var t=this.trackIdMap[Number(e)];t&&t.replay()},e.prototype.pause=function(){this.tracks.forEach((function(e){return e.pause()})),this.playlistLastStartedAt&&(this._elapsedTimeMs=this._elapsedTimeMs+((new Date).getMilliseconds()-this.playlistLastStartedAt.getMilliseconds()),delete this.playlistLastStartedAt),this.playing=!1},Object.defineProperty(e.prototype,"elapsedTimeMs",{get:function(){var e=new Date,t=this.playlistLastStartedAt?this.playlistLastStartedAt:e,n=e.getMilliseconds()-t.getMilliseconds();return this._elapsedTimeMs+n},enumerable:!1,configurable:!0}),e.prototype.next=function(e){var t=this,n=t.assetPool,r=t.currentlyPlayingAssets,o=t.elapsedTimeMs,i=t.listenTagIds,a=o/1e3,s=n.nextForTrack(e,{filterOutAssets:r,elapsedSeconds:a,listenerPoint:this.listenerPoint,listenTagIds:i});return this.trackMap.set(e,s),this._client._triggerOnPlayAssets(),s},e}();t.Playlist=u},751:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistAudiotrack=void 0;var o=n(593),i=n(946),a=n(373),s=["pause","play","playing","waiting","stalled"],u=.01,c=function(){function e(e){var t=this,n=e.audioContext,r=e.windowScope,i=e.audioData,u=e.playlist;this.trackId=i.id,this.timedAssetPriority=i.timed_asset_priority,this.playlist=u,this.playing=!1,this.windowScope=r;var c=new Audio;c.crossOrigin="anonymous",c.loop=!1;var l=n.createMediaElementSource(c),d=n.createGain();l.connect(d),d.connect(n.destination),s.forEach((function(e){return c.addEventListener(e,(function(){return console.log("\t["+t+" audio "+e+" event]")}))})),c.addEventListener("error",(function(){return t.onAudioError()})),c.addEventListener("ended",(function(){return t.onAudioEnded()}));var h=new a.TrackOptions((function(e){return o.getUrlParam(r.location.toString(),e)}),i);this.audioContext=n,this.audioElement=c,this.gainNode=d,this.trackOptions=h,this.mixParams={timedAssetPriority:i.timed_asset_priority},this.setInitialTrackState()}return e.prototype.setInitialTrackState=function(){this.state=i.makeInitialTrackState(this,this.trackOptions)},e.prototype.onAudioError=function(e){console.warn("\t["+this+" audio error, skipping to next track]",e),this.setInitialTrackState()},e.prototype.onAudioEnded=function(){console.log("\t["+this+" audio ended event]")},e.prototype.play=function(){console.log(o.timestamp+" "+this+": "+this.state),this.state?this.state.play():console.warn("No Initial track state. call `setInitialTrackState()`")},e.prototype.updateParams=function(e){void 0===e&&(e={}),this.mixParams=r(r({},this.mixParams),e),this.state?this.state.updateParams(this.mixParams):console.warn("State is undefined!")},e.prototype.holdGain=function(){var e,t=this.audioContext.currentTime;null===(e=this.gainNode)||void 0===e||e.gain.cancelScheduledValues(t)},e.prototype.setZeroGain=function(){var e,t=this.audioContext.currentTime;null===(e=this.gainNode)||void 0===e||e.gain.setValueAtTime(u,t)},e.prototype.fadeIn=function(e){var t=this.currentAsset;if(!t||!t.volume)return console.warn("currentAsset is undefined!"),!1;var n=this.trackOptions.randomVolume*t.volume;try{return this.setZeroGain(),this.playAudio(),this.rampGain(n,e),!0}catch(e){return this.currentAsset=void 0,console.warn(this+" unable to play",t,e),!1}},e.prototype.rampGain=function(e,t,n){var r;void 0===n&&(n="exponentialRampToValueAtTime");var o=this.audioContext.currentTime;console.log("\t[ramping "+this+" gain to "+e.toFixed(2)+" ("+t.toFixed(1)+"s - "+n+")]");var i=null===(r=this.gainNode)||void 0===r?void 0:r.gain;if(i)try{return i.setValueAtTime(i.value,o),i[n](e,o+t),!0}catch(e){return console.warn("Unable to ramp gain "+this,e),!1}},e.prototype.fadeOut=function(e){return this.rampGain(u,e,"linearRampToValueAtTime")},e.prototype.loadNextAsset=function(){var e=this.audioElement,t=this.currentAsset;if(!t||!t.playCount||!t.lastListenTime)return console.warn("currentAsset properties were undefined!"),!1;t&&(t.playCount++,t.lastListenTime=new Date);var n=this.playlist.next(this);if(this.currentAsset=n,n){var r=n.file,o=n.start;return console.log("\t[loading next asset "+this+": "+r+"]"),"string"==typeof r&&(e.src=r),e.currentTime=o>=u?o:u,this.audioElement=e,n}return null},e.prototype.pause=function(){if(console.log(o.timestamp+" pausing "+this),!this.state)return console.warn("pause() was called on a undefined state!");this.state.pause(),this.audioElement&&this.audioElement.pause()},e.prototype.playAudio=function(){this.audioElement&&this.audioElement.play()},e.prototype.pauseAudio=function(){this.holdGain(),this.audioElement&&this.audioElement.pause()},e.prototype.skip=function(){var e=this.state;console.log("Skipping "+this),e&&e.skip()},e.prototype.replay=function(){var e=this.state;console.log("Replaying "+this),e&&e.replay()},e.prototype.transition=function(e){var t=this.state,n=this.playlist.elapsedTimeMs;if(console.log(o.timestamp+" "+this+": '"+t+"'   '"+e+"' ("+(n/1e3).toFixed(1)+"s elapsed)"),!this.state)return console.warn("!current state was undefined");this.state.finish(),this.state=e,this.state.play()},e.prototype.toString=function(){return"Track #"+this.trackId},e}();t.PlaylistAudiotrack=c},126:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Project=void 0;var a=n(145),s=function(){function e(e,t){var n=t.apiClient;this.location={latitude:1,longitude:1},this.projectId=e,this.projectName="(unknown)",this.apiClient=n,this.mixParams={}}return e.prototype.toString=function(){return"Roundware Project '"+this.projectName+"' (#"+this.projectId+")"},e.prototype.connect=function(e){return o(this,void 0,void 0,(function(){var t,n,o,s;return i(this,(function(i){switch(i.label){case 0:t="/projects/"+this.projectId+"/",n={session_id:e},i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.apiClient.get(t,n)];case 2:return o=i.sent(),this.projectName=o.name,this.legalAgreement=o.legal_agreement,this.recordingRadius=o.recording_radius,this.maxRecordingLength=o.max_recording_length,this.location={latitude:o.latitude,longitude:o.longitude},this.mixParams=r({geoListenMode:o.geo_listen_enabled?a.GeoListenMode.MANUAL:a.GeoListenMode.DISABLED,recordingRadius:o.recording_radius,ordering:o.ordering},this.mixParams),[2,e];case 3:return s=i.sent(),console.error("Unable to get Project details",s),[3,4];case 4:return[2]}}))}))},e.prototype.uiconfig=function(e){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return t="/projects/"+this.projectId+"/uiconfig/",n={session_id:e},[4,this.apiClient.get(t,n)];case 1:return[2,r.sent()]}}))}))},e}();t.Project=s},312:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||o(t,e,n)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},u=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.Roundware=t.GeoListenMode=void 0;var c=n(562),l=n(556),d=n(760),h=n(473),p=n(255),f=n(136),v=n(145),m=n(126),y=n(928),g=n(719),w=n(798),b=n(260),_=n(536);i(n(760),t);var C=n(145);Object.defineProperty(t,"GeoListenMode",{enumerable:!0,get:function(){return C.GeoListenMode}});var A=function(){function e(e,t){var n=t.serverUrl,o=t.projectId,i=t.speakerFilters,a=t.assetFilters,s=t.listenerLocation,d=t.user,p=t.geoPosition,g=t.session,C=t.project,A=t.speaker,O=t.asset,S=t.timedAsset,P=t.audiotrack,x=t.assetUpdateInterval,M=t.prefetchSpeakerAudio,E=u(t,["serverUrl","projectId","speakerFilters","assetFilters","listenerLocation","user","geoPosition","session","project","speaker","asset","timedAsset","audiotrack","assetUpdateInterval","prefetchSpeakerAudio"]);if(this._speakerFilters={},this._initialParams={},this._onUpdateLocation=function(){},this._onUpdateAssets=function(){},this._assetData=[],this._onPlayAssets=function(){},this.uiConfig={},this._speakerData=[],this._audioTracksData=[],this._timedAssetData=[],this.windowScope=e,this._serverUrl=n,this._projectId=o,i&&(this._speakerFilters=i),this._assetFilters=a,this._listenerLocation=s,this._initialOptions=E,this._assetUpdateInterval=x||3e5,void 0===this._serverUrl)throw"Roundware objects must be initialized with a serverUrl";if(void 0===this._projectId)throw"Roundware objects must be initialized with a projectId";this._apiClient=new c.ApiClient(window,this._serverUrl),E.apiClient=this._apiClient;var I=window.navigator;this._user=d||new _.User(E),this._geoPosition=p||new f.GeoPosition(I,{geoListenMode:E.geoListenMode,defaultCoords:s}),this._session=g||new y.Session(I,this._projectId,this._geoPosition.isEnabled,E),this._project=C||new m.Project(this._projectId,E),this._speaker=A||new w.Speaker(this._projectId,E),this._asset=O||new l.Asset(this._projectId,E),this._timed_asset=S||new b.TimedAsset(this._projectId,E),this._audiotrack=P||new h.Audiotrack(this._projectId,E),this.uiConfig={};var T=r(r({},this.mixParams),this._initialParams);this._mixer=new v.Mixer({client:this,windowScope:this.windowScope,listenerLocation:this._listenerLocation,prefetchSpeakerAudio:M||!1,mixParams:T})}return e.prototype.updateLocation=function(e){this._listenerLocation=e,this._mixer.updateParams({listenerLocation:e}),this._onUpdateLocation&&this._onUpdateLocation(e)},Object.defineProperty(e.prototype,"onUpdateLocation",{set:function(e){this._onUpdateLocation=e,e(this._geoPosition.getLastCoords())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onUpdateAssets",{set:function(e){this._onUpdateAssets=e,this._assetData&&e(this.assets())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onPlayAssets",{set:function(e){this._onPlayAssets=e,e(this.currentlyPlayingAssets)},enumerable:!1,configurable:!0}),e.prototype._triggerOnPlayAssets=function(){this._onPlayAssets&&this._onPlayAssets(this.currentlyPlayingAssets)},Object.defineProperty(e.prototype,"currentlyPlayingAssets",{get:function(){return this._mixer.playlist&&this._mixer.playlist.currentlyPlayingAssets},enumerable:!1,configurable:!0}),e.prototype.enableGeolocation=function(e){e===v.GeoListenMode.AUTOMATIC?this._geoPosition.enable():this._geoPosition.disable(),this._mixer.updateParams({geoListenMode:e})},e.prototype.disableGeolocation=function(){this._geoPosition.disable(),this._mixer.updateParams({geoListenMode:v.GeoListenMode.DISABLED})},e.prototype.connect=function(){return a(this,void 0,void 0,(function(){var e,t,n=this;return s(this,(function(r){switch(r.label){case 0:this._geoPosition.connect((function(e){return n.updateLocation(e)})),g.logger.info("Initializing Roundware for project ID "+this._projectId),r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this._user.connect()];case 2:return r.sent(),[4,this._session.connect()];case 3:return e=r.sent(),this._sessionId=e,t=[this._project.connect(e),this._project.uiconfig(e).then((function(e){return n.uiConfig=e})),this._speaker.connect(this._speakerFilters).then((function(e){return n._speakerData=e})),this._audiotrack.connect().then((function(e){return n._audioTracksData=e}))],[4,Promise.all(t)];case 4:return r.sent(),console.info("Roundware connected"),[2,{uiConfig:this.uiConfig}];case 5:throw r.sent(),"Sorry, we were unable to connect to Roundware. Please try again.";case 6:return[2]}}))}))},Object.defineProperty(e.prototype,"mixParams",{get:function(){return(this._project||{}).mixParams},enumerable:!1,configurable:!0}),e.prototype.getAssets=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return e||!this._assetData?[3,1]:[2,this._assetData];case 1:return[4,this._apiClient.get("/assets/",r(r({project_id:this._projectId},this._assetFilters),e||{}))];case 2:return[2,t.sent()]}}))}))},Object.defineProperty(e.prototype,"assetPool",{get:function(){return this._mixer.playlist&&this._mixer.playlist.assetPool},enumerable:!1,configurable:!0}),e.prototype.getAssetsFromPool=function(e,t){return void 0===t&&(t={}),a(this,void 0,void 0,(function(){var n,o;return s(this,(function(i){switch(i.label){case 0:return[4,this.loadAssetPool()];case 1:return n=i.sent(),o=r(r({},this.mixParams),t),[2,n.filter((function(t){return e(t,o)!=d.ASSET_PRIORITIES.DISCARD}))]}}))}))},e.prototype.updateAssetPool=function(){return a(this,void 0,void 0,(function(){var e,t,n,o,i,a;return s(this,(function(s){switch(s.label){case 0:return e=this._assetFilters,t=[],this._lastAssetUpdate&&(e=r(r({},e),{created__gte:this._lastAssetUpdate.toISOString()}),t=this.assets()),n=this,i=(o=t).concat,[4,this._asset.connect(e)];case 1:return n._assetData=i.apply(o,[s.sent()]),this._lastAssetUpdate=new Date,(a=this.assetPool)&&this._timedAssetData&&a.updateAssets(this._assetData,this._timedAssetData),this._onUpdateAssets&&this._onUpdateAssets(this._assetData),[2]}}))}))},e.prototype.loadAssetPool=function(){return a(this,void 0,void 0,(function(){var e,t=this;return s(this,(function(n){switch(n.label){case 0:return this._assetData?[3,2]:[4,this.updateAssetPool()];case 1:n.sent(),this._assetDataTimer=setInterval((function(){return t.updateAssetPool()}),this._assetUpdateInterval),n.label=2;case 2:return this._timedAssetData?[3,4]:(e=this,[4,this._timed_asset.connect({})]);case 3:e._timedAssetData=n.sent(),n.label=4;case 4:return[2,this._assetData]}}))}))},e.prototype.activateMixer=function(e){return void 0===e&&(e={}),a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.loadAssetPool()];case 1:return t.sent(),this._mixer.updateParams(e),[2,this._mixer]}}))}))},e.prototype.play=function(e){return void 0===e&&(e=function(){}),this._geoPosition.waitForInitialGeolocation().then(e)},e.prototype.pause=function(){this._mixer.playlist&&this._mixer.playlist.pause()},e.prototype.kill=function(){this._assetDataTimer&&clearInterval(this._assetDataTimer)},e.prototype.replay=function(){},e.prototype.skip=function(){this._mixer.playlist&&this._mixer.playlist.skip()},e.prototype.tags=function(){},e.prototype.update=function(e){this._mixer.playlist&&this._mixer.playlist.updateParams(e)},e.prototype.speakers=function(){return this._speakerData||[]},e.prototype.assets=function(){return this._assetData||[]},e.prototype.timedAssets=function(){return this._timedAssetData||[]},e.prototype.audiotracks=function(){return this._audioTracksData||[]},e.prototype.saveAsset=function(e,t,n){return a(this,void 0,void 0,(function(){return s(this,(function(r){switch(r.label){case 0:return[4,this.makeEnvelope()];case 1:return[2,r.sent().upload(e,t,n)]}}))}))},e.prototype.makeEnvelope=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:if(!this._sessionId)throw new Error("can't save assets without first connecting to the server");return[4,(e=new p.Envelope(this._sessionId,this._apiClient,this._geoPosition,this)).connect()];case 1:return t.sent(),[2,e]}}))}))},e.prototype.findTagDescription=function(e,t){void 0===t&&(t="listen");for(var n=0,r=this.uiConfig[t];n<r.length;n++)for(var o=0,i=r[n].display_items;o<i.length;o++){var a=i[o];if(a.tag_id==e)return a.tag_display_text}},e.prototype.vote=function(e,t,n){return a(this,void 0,void 0,(function(){return s(this,(function(r){return[2,this._apiClient.post("/assets/"+e+"/votes/",{session_id:this._sessionId,vote_type:t,value:n})]}))}))},e.prototype.getAsset=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return s(this,(function(o){if(this._assetData)for(t=0,n=this._assetData;t<n.length;t++)if((r=n[t]).id===e)return[2,r];return[2,this._apiClient.get("/assets/"+e+"/",{session_id:this._sessionId})]}))}))},e.prototype.getEnvelope=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this._apiClient.get("/envelopes/"+e,{session_id:this._sessionId})]}))}))},e}();t.Roundware=A},928:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;var o,i,a,s="Unknown",u=function(){function e(e,t,n,r){(s=e.userAgent).length>127&&(s=s.slice(0,127)),o=t,i=n,a=r.apiClient}return e.prototype.toString=function(){return"Roundware Session #"+void 0},e.prototype.connect=function(){return n(this,void 0,void 0,(function(){var e,t;return r(this,(function(n){switch(n.label){case 0:return e={project_id:o,geo_listen_enabled:i,client_system:s},[4,a.post("/sessions/",e)];case 1:return t=n.sent(),this.sessionId=t.id,[2,this.sessionId]}}))}))},e}();t.Session=u},719:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logger=void 0;var r=n(43);t.logger=r},703:function(e,t){"use strict";function n(e){for(var t,n=e.length-1;n>0;n--){var r=Math.floor(Math.random()*(n+1));t=[e[r],e[n]],e[n]=t[0],e[r]=t[1]}}function r(e){e.sort((function(e,t){return e.weight-t.weight}))}function o(e){console.warn("sortByLikes not implemented yet")}Object.defineProperty(t,"__esModule",{value:!0}),t.sortByProjectDefault=t.sortByLikes=t.sortByWeight=t.sortRandomly=void 0,t.sortRandomly=n,t.sortByWeight=r,t.sortByLikes=o,t.sortByProjectDefault=function(e){switch(e){case"by_weight":return r;case"by_like":return o;case"random":default:return n}}},798:function(e,t){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.Speaker=void 0;var a=function(){function e(e,t){var n=t.apiClient;this._projectId=e,this._apiClient=n}return e.prototype.toString=function(){return"Roundware Speaker (#"+this._projectId+")"},e.prototype.connect=function(e){var t=i(e,[]);return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,this._apiClient.get("/speakers/",n(n({},t),{project_id:this._projectId}))];case 1:return[2,e.sent()]}}))}))},e}();t.Speaker=a},596:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SpeakerTrack=void 0;var i=n(147),a=n(892),s=n(933),u=n(593),c=function(e){return s.default(e)},l=function(){function e(e){var t=e.audioContext,n=e.listenerPoint,r=e.prefetchAudio,o=e.data,i=o.id,a=o.maxvolume,s=o.minvolume,u=o.attenuation_border,l=o.boundary,d=o.attenuation_distance,h=o.uri;this.prefetch=r,this.audioContext=t,this.speakerId=i,this.maxVolume=a,this.minVolume=s,this.attenuationDistanceKm=d/1e3,this.uri=h,this.listenerPoint=n,this.playing=!1,this.attenuationBorderPolygon=c(u),this.attenuationBorderLineString=u,this.outerBoundary=c(l),this.currentVolume=.001}return e.prototype.outerBoundaryContains=function(e){return i.default(e,this.outerBoundary)},e.prototype.attenuationShapeContains=function(e){return i.default(e,this.attenuationBorderPolygon)},e.prototype.attenuationRatio=function(e){return 1-a.default(e,this.attenuationBorderLineString,{units:"kilometers"})/this.attenuationDistanceKm},e.prototype.calculateVolume=function(){var e=this.listenerPoint;if(e){if(this.attenuationShapeContains(e))return this.maxVolume;if(this.outerBoundaryContains(e)){var t=this.maxVolume-this.minVolume;return this.minVolume+t*this.attenuationRatio(e)}return this.minVolume}return this.currentVolume},e.prototype.buildAudio=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,i,a,s,c;return o(this,(function(o){switch(o.label){case 0:return this.audio?[2,this.audio]:(t=(e=this).audioContext,n=e.uri,r=u.cleanAudioURL(n),this.prefetch?[4,fetch(r)]:[3,3]);case 1:return[4,o.sent().blob()];case 2:return a=o.sent(),i=new Audio(URL.createObjectURL(a)),[3,4];case 3:i=new Audio(r),o.label=4;case 4:return i.crossOrigin="anonymous",i.loop=!0,s=t.createMediaElementSource(i),c=t.createGain(),s.connect(c),c.connect(t.destination),this.gainNode=c,this.audio=i,this.audioContext=t,[2,this.audio]}}))}))},e.prototype.updateParams=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return t&&t.listenerPoint&&(this.listenerPoint=t.listenerPoint.geometry),[4,this.updateVolume()];case 1:if(n=r.sent(),!this.audio)throw new Error("Audio is undefined! use buildAudio()");return e==this.playing?[3,4]:n<.05?(this.audio.pause(),[3,4]):[3,2];case 2:return[4,this.audio.play()];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},e.prototype.updateVolume=function(){return r(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return e=this.calculateVolume(),this.currentVolume=e,t=this.audioContext.currentTime+3,[4,this.buildAudio()];case 1:return n.sent(),this.gainNode&&this.gainNode.gain.linearRampToValueAtTime(e,t),[2,e]}}))}))},Object.defineProperty(e.prototype,"logline",{get:function(){return this+" ("+this.uri+")"},enumerable:!1,configurable:!0}),e.prototype.play=function(){return r(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return[4,this.updateVolume()];case 1:if(t.sent()<.05)return[2];t.label=2;case 2:if(t.trys.push([2,4,,5]),!this.audio)throw new Error("Audio is undefined! Please use buildAudio()");return[4,this.audio.play()];case 3:return t.sent(),this.playing=!0,[3,5];case 4:return e=t.sent(),console.error("Unable to play",this.logline,e),[3,5];case 5:return[2]}}))}))},e.prototype.pause=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){if(!this.playing)return[2];try{if(!this.audio)throw new Error("Audio is undefined! Please use buildAudio()");this.audio.pause(),this.playing=!1}catch(e){console.error("Unable to pause",this.logline,e)}return[2]}))}))},e.prototype.toString=function(){return"SpeakerTrack ("+this.speakerId+")"},e}();t.SpeakerTrack=l},260:function(e,t){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.TimedAsset=void 0;var a=function(){function e(e,t){var n=t.apiClient;this._projectId=e,this._apiClient=n}return e.prototype.toString=function(){return"Roundware TimedAssets (#"+this._projectId+")"},e.prototype.connect=function(e){var t=i(e,[]);return r(this,void 0,void 0,(function(){var e;return o(this,(function(r){switch(r.label){case 0:return e=n(n({},t),{project_id:this._projectId}),[4,this._apiClient.get("/timedassets/",e)];case 1:return[2,r.sent()]}}))}))},e}();t.TimedAsset=a},536:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var o=function(){function e(e){var t=e.apiClient,n=e.deviceId,r=void 0===n?"00000000000000":n,o=e.clientType,i=void 0===o?"web":o;this.apiClient=t,this.deviceId=r,this.clientType=i,this.userName="(unknown)"}return e.prototype.toString=function(){return"User "+this.userName+" (deviceId "+this.deviceId+")"},e.prototype.connect=function(){return n(this,void 0,void 0,(function(){var e,t,n;return r(this,(function(r){switch(r.label){case 0:e={device_id:this.deviceId,client_type:this.clientType},r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.apiClient.post("/users/",e)];case 2:return t=r.sent(),this.userName=t.username,this.apiClient.authToken=t.token,[2,t];case 3:return n=r.sent(),console.error("Auth failure",n),[2,{}];case 4:return[2]}}))}))},e}();t.User=o},593:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NO_OP=t.getUrlParam=t.timestamp=t.buildAudioContext=t.randomInt=t.random=t.hasOwnProperty=t.isEmpty=t.coordsToPoints=t.cleanAudioURL=void 0;var r=n(102).point,o=n(513),i=new RegExp(/^https?:\/\//i),a=new RegExp(/\.wav$/i);t.cleanAudioURL=function(e){return e.replace(i,"//").replace(a,".mp3")},t.coordsToPoints=function(e){var t=e.latitude,n=e.longitude;return r([+n,+t])},t.isEmpty=function(e){return!e||e.length<1},t.hasOwnProperty=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.random=function(e,t){void 0===e&&(e=1),void 0===t&&(t=0);var n=Math.min(e,t),r=Math.max(e,t);return n+Math.random()*(r-n)},t.randomInt=function(e,t){void 0===e&&(e=1),void 0===t&&(t=0);var n=Math.ceil(Math.min(e,t)),r=Math.floor(Math.max(e,t));return Math.floor(n+Math.random()*(r-n+1))};var s=["touchstart","touchend","mousedown","keydown"];t.buildAudioContext=function(e){var t=new o.AudioContext;return function(e,t){function n(){t.resume().then(r)}function r(){s.forEach((function(t){return e.removeEventListener(t,n)}))}"suspended"===t.state&&s.forEach((function(t){return e.addEventListener(t,n,!1)}))}(e.document.body,t),t},t.timestamp={toString:function(e){return void 0===e&&(e=new Date),[e.getHours().toString().padStart(2,"0"),e.getMinutes().toString().padStart(2,"0"),e.getSeconds().toString().padStart(2,"0")].join(":")}},t.getUrlParam=function(e,t){var n=new URL(e);return new URLSearchParams(n.search).get(t)},t.NO_OP=function(){}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}return n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(312)}()}));
//# sourceMappingURL=roundware.umd.js.map